<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a factorial design — factorial_designer • DesignLibrary</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create a factorial design — factorial_designer" />
<meta property="og:description" content="A 2^k factorial designer with k factors assigned with independent probabilities. Results in 2^k treatment combinations, each with independent, normally distributed shocks. Estimands are average effects and average interactions of given conditions, averaged over other conditions. Estimation uses regression of demeaned variables with propensity weights." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="https://declaredesign.org"><img height = 125% src = "https://declaredesign.org/images/brand.svg"></a>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Software
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="http://declaredesign.org/r/declaredesign/">DeclareDesign</a>
    </li>
    <li>
      <a href="https://declaredesign.org/r/randomizr/">randomizr</a>
    </li>
    <li>
      <a href="https://declaredesign.org/r/fabricatr/">fabricatr</a>
    </li>
    <li>
      <a href="https://declaredesign.org/r/estimatr/">estimatr</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://discuss.declaredesign.org">Help</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/How_to_Write_and_Contribute_Designers.html">How to Write and Contribute Designers</a>
    </li>
    <li>
      <a href="../articles/How_to_Write_and_Contribute_Designs.html">How to Write and Contribute Designs</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://declaredesign.org/r/designlibrary/">DesignLibrary home</a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->




      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a factorial design</h1>
    <small class="dont-index">Source: <a href='https://github.com/DeclareDesign/DesignLibrary/blob/master/R/factorial_designer.R'><code>R/factorial_designer.R</code></a></small>
    <div class="hidden name"><code>factorial_designer.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A <code>2^k</code> factorial designer with <code>k</code> factors assigned with independent probabilities. Results in <code>2^k</code> treatment combinations, each with independent, normally distributed shocks. Estimands are average effects and average interactions of given conditions, averaged over other conditions. Estimation uses regression of demeaned variables with propensity weights.</p>
    </div>

    <pre class="usage"><span class='fu'>factorial_designer</span><span class='op'>(</span>
  N <span class='op'>=</span> <span class='fl'>256</span>,
  k <span class='op'>=</span> <span class='fl'>3</span>,
  outcome_means <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>2</span><span class='op'>^</span><span class='va'>k</span><span class='op'>)</span>,
  sd <span class='op'>=</span> <span class='fl'>1</span>,
  outcome_sds <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>sd</span>, <span class='fl'>2</span><span class='op'>^</span><span class='va'>k</span><span class='op'>)</span>,
  assignment_probs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='va'>k</span><span class='op'>)</span>,
  outcome_name <span class='op'>=</span> <span class='st'>"Y"</span>,
  treatment_names <span class='op'>=</span> <span class='cn'>NULL</span>,
  args_to_fix <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>N</th>
      <td><p>An integer. Size of sample.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>An integer. The number of factors in the design.</p></td>
    </tr>
    <tr>
      <th>outcome_means</th>
      <td><p>A numeric vector of length <code>2^k</code>. Means for each of the <code>2^k</code> treatment combinations. See `Details` for the correct order of values.</p></td>
    </tr>
    <tr>
      <th>sd</th>
      <td><p>A nonnegative number. Standard deviation for outcomes when all outcomes have identical standard deviations. For outcome-specific standard deviations use <code>outcomes_sds</code>.</p></td>
    </tr>
    <tr>
      <th>outcome_sds</th>
      <td><p>A non negative numeric vector of length <code>2^k</code>. Standard deviations for each of the treatment combinations. See `Details` for the correct order of values.</p></td>
    </tr>
    <tr>
      <th>assignment_probs</th>
      <td><p>A numeric vector of length <code>k</code>. Independent probability of assignment to each treatment.</p></td>
    </tr>
    <tr>
      <th>outcome_name</th>
      <td><p>A character. Name of outcome variable (defaults to "Y"). Must be provided without spacing inside the function <code><a href='https://rdrr.io/r/base/c.html'>c()</a></code> as in <code>outcome_name = c("War")</code>.</p></td>
    </tr>
    <tr>
      <th>treatment_names</th>
      <td><p>A character vector of length <code>k</code>. Name of treatment factors variable (defaults to "T1", "T2", ..., "Tk"). Must be provided without spacing.</p></td>
    </tr>
    <tr>
      <th>args_to_fix</th>
      <td><p>A character vector. Names of arguments to be args_to_fix in design. By default <code>k</code>, <code>probs</code>, <code>outcome_name</code>, and <code>treatment_names</code> are always args_to_fix.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A factorial design.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>factorial_designer</code> creates a factorial design with <code>2^k</code> treatment combinations resulting from <code>k</code> factors, each with two conditions each (<code><a href='https://rdrr.io/r/base/c.html'>c(0,1)</a></code>). The order of the scalar arguments <code>outcome_means</code> and <code>outcome_sds</code> must follow the one returned by <code><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid(rep(list(c(0,1)), k))</a></code>, where each of the columns is a treatment.</p>
<p>Estimands are defined for each combination of treatment assignment as linear combinations of potential outcomes, typically weighted averages of differences. Note that the weighting for the estimand does not reflect treatment assignment probabilities but rather weights each possible condition equally.</p>
<p>For example, in a design with \(k = 3\) factors, the treatment effect of A, (TE_A), averaged over conditions defined by B and C, is given by: $$TE_A = 1/4*(Y_{111} - Y_{011}) + 1/4*(Y_{101} - Y_{001}) + 1/4*(Y_{110} - Y_{010}) + 1/4*(Y_{100} - Y_{000}).$$ The "average interaction of A and B" --- that is the average effect (for a single unit) of A on the effect of B across conditions defined by C --- is: $$TE_{AB} = 1/2*[(Y_{111} - Y_{011}) - (Y_{101} - Y_{001})] + 1/2*[(Y_{110} - Y_{010}) - (Y_{100} - Y_{000})].$$ And the triple interaction---that is, the effect of C on the the effect of B on the effect of A  is: $$TE_{ABC} = [(Y_{111} - Y_{011}) - (Y_{101} - Y_{001})] - [(Y_{110} - Y_{010}) - (Y_{100} - Y_{000})],$$ where \(Y_{abc}\) is short for the potential outcome of Y when A is a,  B is b,  and C is c.</p>
<p>Estimates draw from a regression in which all treatments are demeaned and weighted by the inverse probability of being in the condition they are in. 
Note that in  this demeaned regression the constant captures the average outcome across all conditions --- not the outcome when all units are in the control condition. The coefficient on T1 captures the average effect of T1 across other conditions---not the effect of T1 when other conditions are at 0. And so on.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p><a href='https://declaredesign.org/'>DeclareDesign Team</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># A factorial design using default arguments</span>
<span class='va'>factorial_design</span> <span class='op'>&lt;-</span> <span class='fu'>factorial_designer</span><span class='op'>(</span><span class='op'>)</span>

<span class='co'># A 2 x 2 x 2 factorial design with unequal probabilities of assignment to </span>
<span class='co'># each treatment condition. In this case the estimator weights up by the </span>
<span class='co'># conditional probabilities of assignment.</span>
<span class='va'>factorial_design_2</span> <span class='op'>&lt;-</span> <span class='fu'>factorial_designer</span><span class='op'>(</span>k <span class='op'>=</span> <span class='fl'>3</span>, 
                                         assignment_probs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>2</span>, <span class='fl'>1</span><span class='op'>/</span><span class='fl'>4</span>, <span class='fl'>1</span><span class='op'>/</span><span class='fl'>8</span><span class='op'>)</span>, 
                                         outcome_means <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'>diagnose_design</span><span class='op'>(</span><span class='va'>factorial_design_2</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Mapping from outcomes to estimands </span>
<span class='co'># The mapping between the potential outcomes schedule and the estimands of</span>
<span class='co'># interest is not always easy. To help with intuition consider a 2^3 </span>
<span class='co'># factorial design. You might like to think of a data generating process as</span>
<span class='co'># a collection of marginal effects and interaction effects mapping from</span>
<span class='co'># treatments to outcomes. </span>
<span class='co'># For instance: Y = -.25 + .75*X1 - .25*X2 -.25*X3 + X1*X2*X3</span>
<span class='co'># The vector of implied potential outcome means as a function of conditions  </span>
<span class='co'># could then be generated like this:</span>

<span class='va'>X</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>outcome_means</span> <span class='op'>=</span>  <span class='op'>-</span><span class='fl'>.25</span> <span class='op'>+</span> <span class='va'>X</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>*</span><span class='fl'>3</span><span class='op'>/</span><span class='fl'>4</span> <span class='op'>-</span> <span class='va'>X</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>/</span><span class='fl'>4</span> <span class='op'>-</span> <span class='va'>X</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>/</span><span class='fl'>4</span> <span class='op'>+</span> <span class='va'>X</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>*</span><span class='va'>X</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>*</span><span class='va'>X</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span>
<span class='va'>outcomes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>outcome_means</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>outcomes</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"X1"</span>, <span class='st'>"X2"</span>, <span class='st'>"X3"</span>, <span class='st'>"mean"</span><span class='op'>)</span>
<span class='va'>outcomes</span>
</div><div class='output co'>#&gt;   X1 X2 X3  mean
#&gt; 1  0  0  0 -0.25
#&gt; 2  1  0  0  0.50
#&gt; 3  0  1  0 -0.50
#&gt; 4  1  1  0  0.25
#&gt; 5  0  0  1 -0.50
#&gt; 6  1  0  1  0.25
#&gt; 7  0  1  1 -0.75
#&gt; 8  1  1  1  1.00</div><div class='input'>
<span class='co'># Examination of the outcomes in this table reveals that there is an </span>
<span class='co'># average outcome of 0 (over all conditions), an average effect of treatment</span>
<span class='co'># X1 of 1,  an average effects for X2 and X3 of 0,  the two way interactions </span>
<span class='co'># are .5 (averaged over conditions of the third treatment) and the triple </span>
<span class='co'># interaction is 1.</span>
<span class='co'># These are exactly the estimands calculated by the designer and returned in </span>
<span class='co'># diagnosis.</span>
<span class='va'>factorial_design_3</span> <span class='op'>&lt;-</span> <span class='fu'>factorial_designer</span><span class='op'>(</span>k <span class='op'>=</span> <span class='fl'>3</span>, 
                                         outcome_means <span class='op'>=</span> <span class='va'>outcome_means</span>,
                                         outcome_sds <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>.01</span>, <span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in eval(args[[i]], envir = ee): object 'outcome_means' not found</span></div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://declaredesign.org/r/declaredesign'>DeclareDesign</a></span><span class='op'>)</span>
<span class='fu'><a href='https://declaredesign.org/r/declaredesign/reference/diagnose_design.html'>diagnose_design</a></span><span class='op'>(</span><span class='va'>factorial_design_3</span>, sims <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
<span class='op'>}</span>


</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Graeme Blair, Jasper Cooper, Alexander Coppock, Macartan Humphreys, Clara Bicalho, Neal Fultz, Lily Medina.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


