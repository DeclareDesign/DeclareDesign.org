<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a two-arm design with blocks and clusters — block_cluster_two_arm_designer • DesignLibrary</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create a two-arm design with blocks and clusters — block_cluster_two_arm_designer" />
<meta property="og:description" content="Builds a two-arm design with blocks and clusters." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="https://declaredesign.org"><img height = 125% src = "https://declaredesign.org/images/brand.svg"></a>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Software
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="http://declaredesign.org/r/declaredesign/">DeclareDesign</a>
    </li>
    <li>
      <a href="https://declaredesign.org/r/randomizr/">randomizr</a>
    </li>
    <li>
      <a href="https://declaredesign.org/r/fabricatr/">fabricatr</a>
    </li>
    <li>
      <a href="https://declaredesign.org/r/estimatr/">estimatr</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://discuss.declaredesign.org">Help</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/How_to_Write_and_Contribute_Designers.html">How to Write and Contribute Designers</a>
    </li>
    <li>
      <a href="../articles/How_to_Write_and_Contribute_Designs.html">How to Write and Contribute Designs</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://declaredesign.org/r/designlibrary/">DesignLibrary home</a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->




      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a two-arm design with blocks and clusters</h1>
    <small class="dont-index">Source: <a href='https://github.com/DeclareDesign/DesignLibrary/blob/master/R/block_cluster_two_arm_designer.R'><code>R/block_cluster_two_arm_designer.R</code></a></small>
    <div class="hidden name"><code>block_cluster_two_arm_designer.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Builds a two-arm design with blocks and clusters.</p>
    </div>

    <pre class="usage"><span class='fu'>block_cluster_two_arm_designer</span><span class='op'>(</span>
  N <span class='op'>=</span> <span class='cn'>NULL</span>,
  N_blocks <span class='op'>=</span> <span class='fl'>1</span>,
  N_clusters_in_block <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>N</span><span class='op'>)</span>, <span class='fl'>100</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>N</span><span class='op'>/</span><span class='va'>N_blocks</span><span class='op'>)</span><span class='op'>)</span>,
  N_i_in_cluster <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>N</span><span class='op'>)</span>, <span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>N</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>N_blocks</span> <span class='op'>*</span> <span class='va'>N_clusters_in_block</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
  sd <span class='op'>=</span> <span class='fl'>1</span>,
  sd_block <span class='op'>=</span> <span class='fl'>0.5773</span> <span class='op'>*</span> <span class='va'>sd</span>,
  sd_cluster <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='op'>(</span><span class='va'>sd</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>-</span> <span class='va'>sd_block</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>0.5</span>,
  sd_i_0 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>sd</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>-</span> <span class='va'>sd_block</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>-</span> <span class='va'>sd_cluster</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>0.5</span>,
  sd_i_1 <span class='op'>=</span> <span class='va'>sd_i_0</span>,
  rho <span class='op'>=</span> <span class='fl'>1</span>,
  assignment_probs <span class='op'>=</span> <span class='fl'>0.5</span>,
  control_mean <span class='op'>=</span> <span class='fl'>0</span>,
  ate <span class='op'>=</span> <span class='fl'>0</span>,
  treatment_mean <span class='op'>=</span> <span class='va'>control_mean</span> <span class='op'>+</span> <span class='va'>ate</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  args_to_fix <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>N</th>
      <td><p>An integer. Total number of units. Usually not specified as <code>N</code> is determined by <code>N_blocks</code>, <code>N_clusters_in_block</code>, and <code>N_i_in_cluster</code>. If <code>N_blocks</code>, and  <code>N_clusters_in_block</code>, and <code>N_i_in_cluster</code> are specified then <code>N</code> is overridden. If these are not specified and <code>N</code> is specified then designer attempts to guess sizes of levels to approximate <code>N</code>, with preference for a design without blocks or clusters.</p></td>
    </tr>
    <tr>
      <th>N_blocks</th>
      <td><p>An integer. Number of blocks. Defaults to 1 for no blocks.</p></td>
    </tr>
    <tr>
      <th>N_clusters_in_block</th>
      <td><p>An integer or vector of integers of length <code>N_blocks</code>. Number of clusters in each block. This is the total <code>N</code> when <code>N_blocks</code> and <code>N_i_in_cluster</code> are at default values.</p></td>
    </tr>
    <tr>
      <th>N_i_in_cluster</th>
      <td><p>An integer or vector of integers of length <code><a href='https://rdrr.io/r/base/sum.html'>sum(N_clusters_in_block)</a></code>. Individuals per cluster. Defaults to 1 for no clusters.</p></td>
    </tr>
    <tr>
      <th>sd</th>
      <td><p>A nonnegative number. Overall standard deviation (combining individual level, cluster level, and block level shocks). Defaults to 1. Overridden if incompatible with other user-specified shocks.</p></td>
    </tr>
    <tr>
      <th>sd_block</th>
      <td><p>A nonnegative number. Standard deviation of block level shocks.</p></td>
    </tr>
    <tr>
      <th>sd_cluster</th>
      <td><p>A nonnegative number. Standard deviation of cluster level shock.</p></td>
    </tr>
    <tr>
      <th>sd_i_0</th>
      <td><p>A nonnegative number. Standard deviation of individual level shock in control. If not specified, and when possible given <code>sd_block</code> and <code>sd_cluster</code>, <code>sd_i_0</code> defaults to make total variance = sd.</p></td>
    </tr>
    <tr>
      <th>sd_i_1</th>
      <td><p>A nonnegative number. Standard deviation of individual level shock in treatment. Defaults to <code>sd_i_0</code>.</p></td>
    </tr>
    <tr>
      <th>rho</th>
      <td><p>A number in [-1,1]. Correlation in individual shock between potential outcomes for treatment and control.</p></td>
    </tr>
    <tr>
      <th>assignment_probs</th>
      <td><p>A number or vector of numbers in (0,1). Treatment assignment probability for each block (specified in order of <code>N_clusters_in_block</code>).</p></td>
    </tr>
    <tr>
      <th>control_mean</th>
      <td><p>A number. Average outcome in control.</p></td>
    </tr>
    <tr>
      <th>ate</th>
      <td><p>A number. Average treatment effect. Alternative to specifying <code>treatment_mean</code>. Note that <code>ate</code> is an argument for the designer but it does not appear as an argument in design code (design code uses <code>control_mean</code> and <code>treatment_mean</code> only).</p></td>
    </tr>
    <tr>
      <th>treatment_mean</th>
      <td><p>A number. Average outcome in treatment. If <code>treatment_mean</code> is not provided then it is calculated as <code>control_mean + ate</code>. If both <code>ate</code> and  <code>treatment_mean</code> are provided then only  <code>treatment_mean</code> is used.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical. If TRUE, prints intra-cluster correlation implied by design parameters.</p></td>
    </tr>
    <tr>
      <th>args_to_fix</th>
      <td><p>A character vector. Names of arguments to be args_to_fix in design.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A block cluster two-arm design.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Units are assigned to treatment using complete block cluster random assignment. Treatment effects can be specified either by providing <code>control_mean</code> and <code>treatment_mean</code>
or by specifying an <code>ate</code>. Estimation uses differences in means accounting for blocks and clusters.</p>
<p>In the usual case <code>N</code> is not provided by the user but is determined by <code>N_blocks</code>, <code>N_clusters_in_block</code>, <code>N_i_in_cluster</code> (when these are integers <code>N</code> is the product of these three numbers).</p>
<p>Normal shocks can be specified at the individual, cluster, and block levels. If individual level shocks are not specified and cluster and block 
level variances sum to less than 1, then individual level shocks are set such that total variance in outcomes equals 1.</p>
<p>Key limitations: The designer assumes covariance between potential outcomes at the individual level only.</p>
<p>See <a href='https://declaredesign.org/library/articles/block_cluster_two_arm.html'>vignette online</a>.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p><a href='https://declaredesign.org/'>DeclareDesign Team</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Generate a design using default arguments:</span>
<span class='va'>block_cluster_two_arm_design</span> <span class='op'>&lt;-</span> <span class='fu'>block_cluster_two_arm_designer</span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "The implied ICC in (control) is 0.667"
#&gt; [1] "The implied ICC in (control) conditional on block is  0.5"</div><div class='input'><span class='va'>block_cluster_uneven</span> <span class='op'>&lt;-</span> <span class='fu'>block_cluster_two_arm_designer</span><span class='op'>(</span>
       N_blocks <span class='op'>=</span> <span class='fl'>3</span>, N_clusters_in_block <span class='op'>=</span> <span class='fl'>2</span><span class='op'>:</span><span class='fl'>4</span>, N_i_in_cluster <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>9</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "The implied ICC in (control) is 0.667"
#&gt; [1] "The implied ICC in (control) conditional on block is  0.5"</div><div class='input'><span class='co'># A design in which number of clusters of cluster size is not specified</span>
<span class='co'># but N and block size are:        </span>
<span class='va'>block_cluster_guess</span> <span class='op'>&lt;-</span> <span class='fu'>block_cluster_two_arm_designer</span><span class='op'>(</span>N <span class='op'>=</span> <span class='fl'>24</span>, N_blocks <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "The implied ICC in (control) is 0.667"
#&gt; [1] "The implied ICC in (control) conditional on block is  0.5"</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Graeme Blair, Jasper Cooper, Alexander Coppock, Macartan Humphreys, Clara Bicalho, Neal Fultz, Lily Medina.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


