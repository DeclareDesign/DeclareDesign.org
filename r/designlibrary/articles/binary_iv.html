<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Binary Instrumental Variable • DesignLibrary</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Binary Instrumental Variable">
<meta property="og:description" content="DesignLibrary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="https://declaredesign.org"><img height="125%" src="https://declaredesign.org/images/brand.svg"></a>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Software
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="http://declaredesign.org/r/declaredesign/">DeclareDesign</a>
    </li>
    <li>
      <a href="https://declaredesign.org/r/randomizr/">randomizr</a>
    </li>
    <li>
      <a href="https://declaredesign.org/r/fabricatr/">fabricatr</a>
    </li>
    <li>
      <a href="https://declaredesign.org/r/estimatr/">estimatr</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://discuss.declaredesign.org">Help</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/How_to_Write_and_Contribute_Designers.html">How to Write and Contribute Designers</a>
    </li>
    <li>
      <a href="../articles/How_to_Write_and_Contribute_Designs.html">How to Write and Contribute Designs</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://declaredesign.org/r/designlibrary/">DesignLibrary home</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->




      

      </header><script src="binary_iv_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Binary Instrumental Variable</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DeclareDesign/DesignLibrary/blob/master/../vignettes/binary_iv.Rmd"><code>../vignettes/binary_iv.Rmd</code></a></small>
      <div class="hidden name"><code>binary_iv.Rmd</code></div>

    </div>

    
    
<p>Instrumental variables methods are often used in experimental or observational settings where we <em>cannot</em> credibly assume the treatment of interest is randomly assigned, but can assume the treatment is assigned my some third variable that’s unrelated to the outcome of interest.</p>
<p>Take two examples of causal relationships researchers might be interested in observing: the effect of distributive benefits on voter turnout and the effect of fertilizer use on farmers’ crop yield. In both cases, the distribution of resources or the use of fertilizer may depend on the outcome we wish to study — on the one hand, politicians may disburse funds according to local electoral characteristics, and on the other, famers with higher crop yield might be both more likely to use fertilizers. Instrumental variables can be a useful approach in these contexts where a treatment <span class="math inline">\(X\)</span> is endogenous to an outcome <span class="math inline">\(Y\)</span>.</p>
<p>Strong instrumental variables satisfy four key assumptions:</p>
<ul>
<li>
<em>Relevance</em>: The instrument <span class="math inline">\(Z\)</span> has a causal effect on the treatment <span class="math inline">\(X\)</span>.</li>
<li>
<em>Exclusion restriction</em>: The instrument <span class="math inline">\(Z\)</span> affects the outcome <span class="math inline">\(Y\)</span> only through the treatment <span class="math inline">\(X\)</span>.</li>
<li>
<em>Exchangeability</em> (or <em>independence</em>): The instrument <span class="math inline">\(Z\)</span> is as good as randomly assigned (i.e., there is no confounding for the effect of <span class="math inline">\(Z\)</span> on <span class="math inline">\(Y\)</span>).</li>
<li>
<em>Monotonicity</em>: For all units <span class="math inline">\(i\)</span>, <span class="math inline">\(X_i(z_1) \geqslant X_i(x_2)\)</span> when <span class="math inline">\(z_1 \geqslant z_2\)</span> (i.e., there are no units that always defy their assignment).</li>
</ul>
<p>Using the examples above, researchers could choose to instrument distributive benefits with a naturally occurring disaster — the occurence of a hurricane is correlated with the disbursement of relief aid by the government but may be independent of voter turnout. Similarly, researchers might randomly assign some farmers fertilizer vouchers as an instrument for fertilizer use.</p>
<p>The <code><a href="../reference/binary_iv_designer.html">binary_iv_designer()</a></code> function allows researchers to declare a design of a single instrument <span class="math inline">\(Z\)</span> to estimate the effect of an endogenous treatment <span class="math inline">\(X\)</span> on an outcome <span class="math inline">\(Y\)</span>, all of which are binary variables. Below we declare a design using the fertilizer example.</p>
<div id="design-declaration" class="section level2">
<h2 class="hasAnchor">
<a href="#design-declaration" class="anchor"></a>Design Declaration</h2>
<ul>
<li>
<p><strong>M</strong>odel:</p>
<p>We assume our sample has three out of four possible compliance types in a sample of <span class="math inline">\(N\)</span> farmers: always-takers, never-takers, and compliers. In order for the monotonicy assumption to hold, we assume there are no defiers in our sample (no farmers who will adopt fertilizer use if not given the voucher, and who will not adopt it if given the voucher). Below is how we define <span class="math inline">\(X(Z)\)</span> with <span class="math inline">\(Z \in {0,1}\)</span> for each type:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Type</th>
<th align="right"><span class="math inline">\(X_i(0)\)</span></th>
<th align="right"><span class="math inline">\(X_i(1)\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Always-taker</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Never-taker</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Complier</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Defier</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>We consider a population of size <span class="math inline">\(N\)</span> and we define potential outcome <span class="math inline">\(Y\)</span> (in this case crop yield) as a linear function of the form <span class="math inline">\(Y_{i,type} = \alpha_{type} + \beta_{type} * X_i + \delta_{type} * Z_i + u_y\)</span>, where <span class="math inline">\(u_y\)</span> is a normally distributed individual-level shock. We consider the treatment to have heterogeneous effects among different complier types.</p>
</li>
<li>
<p><strong>I</strong>nquiry:</p>
<p>Firstly, we define the first-stage effect of <span class="math inline">\(Z\)</span> on <span class="math inline">\(X\)</span> as <span class="math inline">\(E[X(Z=1) - X(Z=0)]\)</span>.</p>
<p>Our second estimand of interest is the average effect of fertilizer use (our endogenous treatment, <span class="math inline">\(X\)</span>), on crop productivity: <span class="math inline">\(ATE = E[Y(X = 1) - Y(X = 0)]\)</span>.</p>
<p>Thirdly, we are interested in the average treatment effect among compliers (farmers who use fertilizers when awarded the vouchers but who will not use it if not given voucher): <span class="math inline">\(LATE = E[Y(X = 1) - Y(X = 0) | type_i = complier]\)</span>.</p>
<p>Lastly, when monotonicity does not hold, but independence and exclusion restriction do, we define the estimand as a weighted average of treatment effects for compliers and defiers: <span class="math inline">\(LATE_{het} = \frac{Pr(type = c)}{Pr(type = c) - Pr(type = d)}*E[Y_i(1)-Y_i(0)| type = c] - \frac{Pr(type = d)}{Pr(type = c) - Pr(type = d)}*E[Y_i(1)-Y_i(0)| type = d]\)</span>, where <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span> are compliers and defiers, respectively <span class="citation">(see Imbens 2014: 34)</span>.</p>
</li>
<li>
<p><strong>D</strong>ata strategy:</p>
<p>We collect survey data on a representative sample of 400 farmers and randomly assign fertilizer vouchers with a probability of 0.5.</p>
</li>
<li>
<p><strong>A</strong>nswer strategy:</p>
<p>We estimate the first-stage effect by calculating the difference-in-means estimator of the function <span class="math inline">\(X ~ Z\)</span>. For an estimation of the <span class="math inline">\(ATE\)</span>, <span class="math inline">\(LATE\)</span>, and <span class="math inline">\(LATE_{het}\)</span> we estimate the effect of endogenous treatment <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> and use a two-stage least squares (2SLS) estimation.</p>
</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">type_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>
<span class="va">assignment_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>
<span class="va">outcome_sd</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>

<span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_population.html">declare_population</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">N</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, 
    <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="va">type_probs</span><span class="op">)</span>, type_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Always"</span>, 
    <span class="st">"Never"</span>, <span class="st">"Complier"</span>, <span class="st">"Defier"</span><span class="op">)</span><span class="op">[</span><span class="va">type</span><span class="op">]</span>, u_Z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>, 
    u_Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="op">*</span> <span class="va">outcome_sd</span>, Z <span class="op">=</span> <span class="op">(</span><span class="va">u_Z</span> <span class="op">&lt;</span> <span class="va">assignment_probs</span><span class="op">[</span><span class="va">type</span><span class="op">]</span><span class="op">)</span>, 
    X <span class="op">=</span> <span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="va">Z</span> <span class="op">+</span> <span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> 
        <span class="va">Z</span><span class="op">)</span><span class="op">)</span>
<span class="va">potential_outcomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_potential_outcomes.html">declare_potential_outcomes</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">a</span><span class="op">[</span><span class="va">type</span><span class="op">]</span> <span class="op">+</span> 
    <span class="va">b</span><span class="op">[</span><span class="va">type</span><span class="op">]</span> <span class="op">*</span> <span class="va">X</span> <span class="op">+</span> <span class="va">d</span><span class="op">[</span><span class="va">type</span><span class="op">]</span> <span class="op">*</span> <span class="va">Z</span> <span class="op">+</span> <span class="va">u_Y</span>, assignment_variables <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span>
<span class="va">reveal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/reveal_outcomes.html">declare_reveal</a></span><span class="op">(</span>outcome_variables <span class="op">=</span> <span class="va">Y</span>, assignment_variables <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span>
<span class="va">estimand</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_estimand.html">declare_estimand</a></span><span class="op">(</span>first_stage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> 
    <span class="fl">3</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span>, ate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y_X_1</span> <span class="op">-</span> <span class="va">Y_X_0</span><span class="op">)</span>, late <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y_X_1</span><span class="op">[</span><span class="va">type</span> <span class="op">==</span> 
    <span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">Y_X_0</span><span class="op">[</span><span class="va">type</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span><span class="op">)</span>, late_het <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">*</span> 
    <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y_X_1</span><span class="op">[</span><span class="va">type</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">Y_X_0</span><span class="op">[</span><span class="va">type</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> 
    <span class="fl">4</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y_X_1</span><span class="op">[</span><span class="va">type</span> <span class="op">==</span> <span class="fl">4</span><span class="op">]</span> <span class="op">-</span> <span class="va">Y_X_0</span><span class="op">[</span><span class="va">type</span> <span class="op">==</span> <span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> 
    <span class="fl">3</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">estimator_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_estimator.html">declare_estimator</a></span><span class="op">(</span><span class="va">X</span> <span class="op">~</span> <span class="va">Z</span>, estimand <span class="op">=</span> <span class="st">"first_stage"</span>, 
    label <span class="op">=</span> <span class="st">"d-i-m"</span><span class="op">)</span>
<span class="va">estimator_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_estimator.html">declare_estimator</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, estimand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ate"</span>, 
    <span class="st">"late"</span>, <span class="st">"late_het"</span><span class="op">)</span>, model <span class="op">=</span> <span class="va">lm_robust</span>, label <span class="op">=</span> <span class="st">"lm_robust"</span><span class="op">)</span>
<span class="va">estimator_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_estimator.html">declare_estimator</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">|</span> <span class="va">Z</span>, estimand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ate"</span>, 
    <span class="st">"late"</span>, <span class="st">"late_het"</span><span class="op">)</span>, model <span class="op">=</span> <span class="va">iv_robust</span>, label <span class="op">=</span> <span class="st">"iv_robust"</span><span class="op">)</span>
<span class="va">binary_iv_design</span> <span class="op">&lt;-</span> <span class="va">population</span> <span class="op">+</span> <span class="va">potential_outcomes</span> <span class="op">+</span> <span class="va">reveal</span> <span class="op">+</span> 
    <span class="va">estimand</span> <span class="op">+</span> <span class="va">estimator_1</span> <span class="op">+</span> <span class="va">estimator_2</span> <span class="op">+</span> <span class="va">estimator_3</span></code></pre></div>
</div>
<div id="takeaways" class="section level2">
<h2 class="hasAnchor">
<a href="#takeaways" class="anchor"></a>Takeaways</h2>
<p>We now diagnose the design above and compare our estimates with those of designs that violate the first three assumptions one by one.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Violate relevance of instrument for treatment (no first-stage effects)</span>
<span class="va">iv_nonrelevant</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binary_iv_designer.html">binary_iv_designer</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">500</span>, assignment_probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.3</span>, <span class="fl">.7</span>, <span class="fl">.5</span><span class="op">)</span>, b_Y <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>

<span class="co"># Violate relevance of instrument for treatment (no first-stage effects)</span>
<span class="va">iv_nonrandom</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binary_iv_designer.html">binary_iv_designer</a></span><span class="op">(</span>type_probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">.5</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, b_Y <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>

<span class="co"># Violate exclusion restriction</span>
<span class="va">iv_nonexcl</span>     <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binary_iv_designer.html">binary_iv_designer</a></span><span class="op">(</span>d_Y <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span></code></pre></div>
<p>We also compare estimates across designs in which we assume violation of the monotonicity assumption with homogeneous and heterogeneous treatment effects across complier types.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Violates monotonicity with homogeneous treatment effects</span>
<span class="va">iv_defiers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binary_iv_designer.html">binary_iv_designer</a></span><span class="op">(</span>type_probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">.8</span>,<span class="fl">.2</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Violates monotonicity with heterogeneous treatment effects</span>
<span class="va">iv_het</span>     <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binary_iv_designer.html">binary_iv_designer</a></span><span class="op">(</span>type_probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">.8</span>,<span class="fl">.2</span><span class="op">)</span>, 
                                 b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="va">diagnoses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/diagnose_design.html">diagnose_designs</a></span><span class="op">(</span><span class="va">binary_iv_design</span>, <span class="va">iv_nonrelevant</span>, <span class="va">iv_nonrandom</span>, 
                              <span class="va">iv_nonexcl</span>, <span class="va">iv_defiers</span>, <span class="va">iv_het</span>, sims <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></code></pre></div>
<p>We highlight a few takeaways. Firstly, our estimates are unbiased when all assumption hold. We show that violating any of the first three assumptions yields biased estimates.</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">Design Label</th>
<th align="left">Estimand Label</th>
<th align="left">Estimator Label</th>
<th align="left">Bias</th>
<th align="left">Power</th>
<th align="left">Mean Estimand</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">binary_iv_design</td>
<td align="left">ate</td>
<td align="left">iv_robust</td>
<td align="left">0.02</td>
<td align="left">0.72</td>
<td align="left">0.50</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">binary_iv_design</td>
<td align="left">ate</td>
<td align="left">lm_robust</td>
<td align="left">0.02</td>
<td align="left">0.72</td>
<td align="left">0.50</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">binary_iv_design</td>
<td align="left">late</td>
<td align="left">iv_robust</td>
<td align="left">0.02</td>
<td align="left">0.72</td>
<td align="left">0.50</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="left">binary_iv_design</td>
<td align="left">late</td>
<td align="left">lm_robust</td>
<td align="left">0.02</td>
<td align="left">0.72</td>
<td align="left">0.50</td>
</tr>
<tr class="odd">
<td align="left">15</td>
<td align="left">iv_nonrelevant</td>
<td align="left">ate</td>
<td align="left">iv_robust</td>
<td align="left">-0.98</td>
<td align="left">0.20</td>
<td align="left">0.50</td>
</tr>
<tr class="even">
<td align="left">17</td>
<td align="left">iv_nonrelevant</td>
<td align="left">ate</td>
<td align="left">lm_robust</td>
<td align="left">0.58</td>
<td align="left">1.00</td>
<td align="left">0.50</td>
</tr>
<tr class="odd">
<td align="left">21</td>
<td align="left">iv_nonrelevant</td>
<td align="left">late</td>
<td align="left">iv_robust</td>
<td align="left">-0.98</td>
<td align="left">0.20</td>
<td align="left">0.50</td>
</tr>
<tr class="even">
<td align="left">23</td>
<td align="left">iv_nonrelevant</td>
<td align="left">late</td>
<td align="left">lm_robust</td>
<td align="left">0.58</td>
<td align="left">1.00</td>
<td align="left">0.50</td>
</tr>
<tr class="odd">
<td align="left">29</td>
<td align="left">iv_nonrandom</td>
<td align="left">ate</td>
<td align="left">iv_robust</td>
<td align="left">0.02</td>
<td align="left">0.04</td>
<td align="left">0.50</td>
</tr>
<tr class="even">
<td align="left">31</td>
<td align="left">iv_nonrandom</td>
<td align="left">ate</td>
<td align="left">lm_robust</td>
<td align="left">1.02</td>
<td align="left">1.00</td>
<td align="left">0.50</td>
</tr>
<tr class="odd">
<td align="left">35</td>
<td align="left">iv_nonrandom</td>
<td align="left">late</td>
<td align="left">iv_robust</td>
<td align="left">NA</td>
<td align="left">0.04</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">37</td>
<td align="left">iv_nonrandom</td>
<td align="left">late</td>
<td align="left">lm_robust</td>
<td align="left">NA</td>
<td align="left">1.00</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">43</td>
<td align="left">iv_nonexcl</td>
<td align="left">ate</td>
<td align="left">iv_robust</td>
<td align="left">0.30</td>
<td align="left">0.12</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">45</td>
<td align="left">iv_nonexcl</td>
<td align="left">ate</td>
<td align="left">lm_robust</td>
<td align="left">0.69</td>
<td align="left">1.00</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">49</td>
<td align="left">iv_nonexcl</td>
<td align="left">late</td>
<td align="left">iv_robust</td>
<td align="left">0.30</td>
<td align="left">0.12</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">51</td>
<td align="left">iv_nonexcl</td>
<td align="left">late</td>
<td align="left">lm_robust</td>
<td align="left">0.69</td>
<td align="left">1.00</td>
<td align="left">0.00</td>
</tr>
</tbody>
</table>
<p>In the absence of the monotonicity assumption, our IV estimates are less biased for the LATE than the ATE estimand in the presence of heterogeneous treatment effects. Moreover, in these cases, the IV is best at estimating the weighted average of treatment effects for compliers and defiers (<span class="math inline">\(LATE_{het}\)</span>).</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">Design Label</th>
<th align="left">Estimand Label</th>
<th align="left">Estimator Label</th>
<th align="left">Bias</th>
<th align="left">Power</th>
<th align="left">Mean Estimand</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">57</td>
<td align="left">iv_defiers</td>
<td align="left">ate</td>
<td align="left">iv_robust</td>
<td align="left">-0.00</td>
<td align="left">0.04</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">59</td>
<td align="left">iv_defiers</td>
<td align="left">ate</td>
<td align="left">lm_robust</td>
<td align="left">0.05</td>
<td align="left">0.04</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">63</td>
<td align="left">iv_defiers</td>
<td align="left">late</td>
<td align="left">iv_robust</td>
<td align="left">-0.00</td>
<td align="left">0.04</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">65</td>
<td align="left">iv_defiers</td>
<td align="left">late</td>
<td align="left">lm_robust</td>
<td align="left">0.05</td>
<td align="left">0.04</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">67</td>
<td align="left">iv_defiers</td>
<td align="left">late_het</td>
<td align="left">iv_robust</td>
<td align="left">-0.00</td>
<td align="left">0.04</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">69</td>
<td align="left">iv_defiers</td>
<td align="left">late_het</td>
<td align="left">lm_robust</td>
<td align="left">0.05</td>
<td align="left">0.04</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">71</td>
<td align="left">iv_het</td>
<td align="left">ate</td>
<td align="left">iv_robust</td>
<td align="left">0.25</td>
<td align="left">0.52</td>
<td align="left">0.41</td>
</tr>
<tr class="even">
<td align="left">73</td>
<td align="left">iv_het</td>
<td align="left">ate</td>
<td align="left">lm_robust</td>
<td align="left">-0.02</td>
<td align="left">0.40</td>
<td align="left">0.41</td>
</tr>
<tr class="odd">
<td align="left">77</td>
<td align="left">iv_het</td>
<td align="left">late</td>
<td align="left">iv_robust</td>
<td align="left">0.15</td>
<td align="left">0.52</td>
<td align="left">0.50</td>
</tr>
<tr class="even">
<td align="left">79</td>
<td align="left">iv_het</td>
<td align="left">late</td>
<td align="left">lm_robust</td>
<td align="left">-0.12</td>
<td align="left">0.40</td>
<td align="left">0.50</td>
</tr>
<tr class="odd">
<td align="left">81</td>
<td align="left">iv_het</td>
<td align="left">late_het</td>
<td align="left">iv_robust</td>
<td align="left">-0.01</td>
<td align="left">0.52</td>
<td align="left">0.66</td>
</tr>
<tr class="even">
<td align="left">83</td>
<td align="left">iv_het</td>
<td align="left">late_het</td>
<td align="left">lm_robust</td>
<td align="left">-0.28</td>
<td align="left">0.40</td>
<td align="left">0.66</td>
</tr>
</tbody>
</table>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-imbens2014instrumental">
<p>Imbens, Guido. 2014. “Instrumental Variables: An Econometrician’s Perspective.” National Bureau of Economic Research.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Graeme Blair, Jasper Cooper, Alexander Coppock, Macartan Humphreys, Clara Bicalho, Neal Fultz, Lily Medina.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
