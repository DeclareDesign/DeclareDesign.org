<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pre-Test Post-Test Design • DesignLibrary</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Pre-Test Post-Test Design">
<meta property="og:description" content="DesignLibrary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="https://declaredesign.org"><img height="125%" src="https://declaredesign.org/images/brand.svg"></a>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Software
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="http://declaredesign.org/r/declaredesign/">DeclareDesign</a>
    </li>
    <li>
      <a href="https://declaredesign.org/r/randomizr/">randomizr</a>
    </li>
    <li>
      <a href="https://declaredesign.org/r/fabricatr/">fabricatr</a>
    </li>
    <li>
      <a href="https://declaredesign.org/r/estimatr/">estimatr</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://discuss.declaredesign.org">Help</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/How_to_Write_and_Contribute_Designers.html">How to Write and Contribute Designers</a>
    </li>
    <li>
      <a href="../articles/How_to_Write_and_Contribute_Designs.html">How to Write and Contribute Designs</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://declaredesign.org/r/designlibrary/">DesignLibrary home</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->




      

      </header><script src="pretest_posttest_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Pre-Test Post-Test Design</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DeclareDesign/DesignLibrary/blob/master/../vignettes/pretest_posttest.Rmd"><code>../vignettes/pretest_posttest.Rmd</code></a></small>
      <div class="hidden name"><code>pretest_posttest.Rmd</code></div>

    </div>

    
    
<p>Pre-test post-test designs are designs in which researchers estimate the change in outcomes before and after an intervention. These designs are often preferred to post-test-only designs (which simply compare outcomes between control and treatment group <em>after</em> treatment assignment), because they enable much more efficient estimation and more informed assessment of imbalance.</p>
<p>Nevertheless, baseline measurement often comes at a cost: when faced with budget constraints, researchers may be forced to decrease endline sample size in order to facilitate a baseline. Whether it is worth doing so often depends on how well the baseline will predict outcomes at endline.</p>
<p>Furthermore, there is much debate about how best to estimate treatment effects in such designs: when are researchers better off using change scores versus conditioning on the baseline?</p>
<p>Below we consider the example of a pre-test post-test applied to a study that seeks to evaluate the effect of a family-planning program on the incidence of teenage pregnancy.</p>
<div id="design-declaration" class="section level2">
<h2 class="hasAnchor">
<a href="#design-declaration" class="anchor"></a>Design Declaration</h2>
<ul>
<li>
<p><strong>M</strong>odel:</p>
<p>We define a population of size <span class="math inline">\(N\)</span>, where effect at time <span class="math inline">\(t = 1\)</span> (pre-program) and <span class="math inline">\(t = 2\)</span> (post-program) are taken from a normal distribution of mean 0 and standard deviation smaller than 1. We assume pre- and post-test outcomes to be highly and positively correlated (<span class="math inline">\(\rho = 0.5\)</span>). We also expect subjects to leave the study at a rate of 10%, meaning we do not observe post-treatment outcomes for a tenth of the sample.</p>
</li>
<li>
<p><strong>I</strong>nquiry:</p>
<p>We wish to know the average effect of family pregnancy programs <span class="math inline">\(Z\)</span> on rates of teenage pregnancy. Formally: <span class="math inline">\(E[Y(Z = 1) - Y(Z = 0) \mid t = 2]\)</span>, where <span class="math inline">\(Z = 1\)</span> denotes assignment to the program.</p>
</li>
<li>
<p><strong>D</strong>ata strategy:</p>
<p>We observe the incidence of teenage pregnancy (<span class="math inline">\(Y_i\)</span>) for individual <span class="math inline">\(i\)</span> for a sample of 100 individuals at time <span class="math inline">\(t = 1\)</span> (just prior to treatment) and at time <span class="math inline">\(t = 2\)</span> (a year after treatment). We randomly assign 50 out of 100 women between the ages of 15 and 19 to receive treatment.</p>
</li>
<li>
<p><strong>A</strong>nswer strategy:</p>
<p>We define three estimators. First, we estimate effects on the ``change score’’: the dependent variable is defined as the difference between observed post- and pre-treatment outcomes. The second estimator treats only the post-treatment outcome as the dependent variable, but conditions on the pre-treatment outcome on the righthand side of the regression. Finally, we also look at effects when we only use post-test outcome measures, so as to evaluate the gain from using a baseline.</p>
</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">ate</span> <span class="op">&lt;-</span> <span class="fl">0.25</span>
<span class="va">sd_1</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">sd_2</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">attrition_rate</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>

<span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_population.html">declare_population</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">N</span>, u_t1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="op">*</span> 
    <span class="va">sd_1</span>, u_t2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">rho</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">u_t1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">rho</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> 
    <span class="va">sd_2</span>, Y_t1 <span class="op">=</span> <span class="va">u_t1</span><span class="op">)</span>
<span class="va">potential_outcomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_potential_outcomes.html">declare_potential_outcomes</a></span><span class="op">(</span><span class="va">Y_t2</span> <span class="op">~</span> <span class="va">u_t2</span> <span class="op">+</span> 
    <span class="va">ate</span> <span class="op">*</span> <span class="va">Z</span><span class="op">)</span>
<span class="va">estimand</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_inquiry.html">declare_inquiry</a></span><span class="op">(</span>ATE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y_t2_Z_1</span> <span class="op">-</span> <span class="va">Y_t2_Z_0</span><span class="op">)</span><span class="op">)</span>
<span class="va">assignment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_assignment.html">declare_assignment</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">report</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_assignment.html">declare_assignment</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">attrition_rate</span>, assignment_variable <span class="op">=</span> <span class="va">R</span><span class="op">)</span>
<span class="va">reveal_t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_reveal.html">declare_reveal</a></span><span class="op">(</span><span class="va">Y_t2</span><span class="op">)</span>
<span class="va">manipulation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_step.html">declare_step</a></span><span class="op">(</span>difference <span class="op">=</span> <span class="op">(</span><span class="va">Y_t2</span> <span class="op">-</span> <span class="va">Y_t1</span><span class="op">)</span>, 
    handler <span class="op">=</span> <span class="va">fabricate</span><span class="op">)</span>
<span class="va">pretest_lhs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_estimator.html">declare_estimator</a></span><span class="op">(</span><span class="va">difference</span> <span class="op">~</span> <span class="va">Z</span>, model <span class="op">=</span> <span class="va">lm_robust</span>, 
    inquiry <span class="op">=</span> <span class="va">estimand</span>, subset <span class="op">=</span> <span class="va">R</span> <span class="op">==</span> <span class="fl">1</span>, label <span class="op">=</span> <span class="st">"Change score"</span><span class="op">)</span>
<span class="va">pretest_rhs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_estimator.html">declare_estimator</a></span><span class="op">(</span><span class="va">Y_t2</span> <span class="op">~</span> <span class="va">Z</span> <span class="op">+</span> <span class="va">Y_t1</span>, model <span class="op">=</span> <span class="va">lm_robust</span>, 
    inquiry <span class="op">=</span> <span class="va">estimand</span>, subset <span class="op">=</span> <span class="va">R</span> <span class="op">==</span> <span class="fl">1</span>, label <span class="op">=</span> <span class="st">"Condition on pretest"</span><span class="op">)</span>
<span class="va">posttest_only</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_estimator.html">declare_estimator</a></span><span class="op">(</span><span class="va">Y_t2</span> <span class="op">~</span> <span class="va">Z</span>, model <span class="op">=</span> <span class="va">lm_robust</span>, 
    inquiry <span class="op">=</span> <span class="va">estimand</span>, label <span class="op">=</span> <span class="st">"Posttest only"</span><span class="op">)</span>
<span class="va">pretest_posttest_design</span> <span class="op">&lt;-</span> <span class="va">population</span> <span class="op">+</span> <span class="va">potential_outcomes</span> <span class="op">+</span> 
    <span class="va">estimand</span> <span class="op">+</span> <span class="va">assignment</span> <span class="op">+</span> <span class="va">reveal_t2</span> <span class="op">+</span> <span class="va">report</span> <span class="op">+</span> <span class="va">manipulation</span> <span class="op">+</span> 
    <span class="va">pretest_lhs</span> <span class="op">+</span> <span class="va">pretest_rhs</span> <span class="op">+</span> <span class="va">posttest_only</span></code></pre></div>
</div>
<div id="takeaways" class="section level2">
<h2 class="hasAnchor">
<a href="#takeaways" class="anchor"></a>Takeaways</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diagnosis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/diagnose_design.html">diagnose_design</a></span><span class="op">(</span><span class="va">pretest_posttest_design</span>, sims <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: We recommend you choose a higher number of simulations than 25 for the
## top level of simulation.</code></pre>
<table class="table">
<colgroup>
<col width="17%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="7%">
<col width="11%">
<col width="10%">
<col width="6%">
<col width="10%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left">Estimator Label</th>
<th align="left">N Sims</th>
<th align="left">Bias</th>
<th align="left">RMSE</th>
<th align="left">Power</th>
<th align="left">Coverage</th>
<th align="left">Mean Estimate</th>
<th align="left">SD Estimate</th>
<th align="left">Mean Se</th>
<th align="left">Type S Rate</th>
<th align="left">Mean Inquiry</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Change score</td>
<td align="left">25</td>
<td align="left">-0.03</td>
<td align="left">0.21</td>
<td align="left">0.12</td>
<td align="left">0.92</td>
<td align="left">0.22</td>
<td align="left">0.22</td>
<td align="left">0.21</td>
<td align="left">0.00</td>
<td align="left">0.25</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">(0.04)</td>
<td align="left">(0.03)</td>
<td align="left">(0.06)</td>
<td align="left">(0.06)</td>
<td align="left">(0.04)</td>
<td align="left">(0.03)</td>
<td align="left">(0.00)</td>
<td align="left">NA</td>
<td align="left">(0.00)</td>
</tr>
<tr class="odd">
<td align="left">Condition on pretest</td>
<td align="left">25</td>
<td align="left">-0.06</td>
<td align="left">0.17</td>
<td align="left">0.08</td>
<td align="left">1.00</td>
<td align="left">0.19</td>
<td align="left">0.16</td>
<td align="left">0.18</td>
<td align="left">0.00</td>
<td align="left">0.25</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">(0.03)</td>
<td align="left">(0.02)</td>
<td align="left">(0.05)</td>
<td align="left">(0.00)</td>
<td align="left">(0.03)</td>
<td align="left">(0.02)</td>
<td align="left">(0.00)</td>
<td align="left">NA</td>
<td align="left">(0.00)</td>
</tr>
<tr class="odd">
<td align="left">Posttest only</td>
<td align="left">25</td>
<td align="left">-0.12</td>
<td align="left">0.20</td>
<td align="left">0.00</td>
<td align="left">0.92</td>
<td align="left">0.13</td>
<td align="left">0.17</td>
<td align="left">0.20</td>
<td align="left">NaN</td>
<td align="left">0.25</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">(0.03)</td>
<td align="left">(0.03)</td>
<td align="left">(0.00)</td>
<td align="left">(0.06)</td>
<td align="left">(0.03)</td>
<td align="left">(0.02)</td>
<td align="left">(0.00)</td>
<td align="left">NA</td>
<td align="left">(0.00)</td>
</tr>
</tbody>
</table>
<ul>
<li>We see that the change score approach is less powerful than even the naive estimator! That’s because it essentially sums the variances from both periods. Any time invariant noise is being compounded by summing.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Graeme Blair, Jasper Cooper, Alexander Coppock, Macartan Humphreys, Clara Bicalho, Neal Fultz, Lily Medina.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
