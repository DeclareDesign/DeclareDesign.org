<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spillover Design • DesignLibrary</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Spillover Design">
<meta property="og:description" content="DesignLibrary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="https://declaredesign.org"><img height="125%" src="https://declaredesign.org/images/brand.svg"></a>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Software
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="http://declaredesign.org/r/declaredesign/">DeclareDesign</a>
    </li>
    <li>
      <a href="https://declaredesign.org/r/randomizr/">randomizr</a>
    </li>
    <li>
      <a href="https://declaredesign.org/r/fabricatr/">fabricatr</a>
    </li>
    <li>
      <a href="https://declaredesign.org/r/estimatr/">estimatr</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://discuss.declaredesign.org">Help</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/How_to_Write_and_Contribute_Designers.html">How to Write and Contribute Designers</a>
    </li>
    <li>
      <a href="../articles/How_to_Write_and_Contribute_Designs.html">How to Write and Contribute Designs</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://declaredesign.org/r/designlibrary/">DesignLibrary home</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->




      

      </header><script src="spillover_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Spillover Design</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DeclareDesign/DesignLibrary/blob/master/../vignettes/spillover.Rmd"><code>../vignettes/spillover.Rmd</code></a></small>
      <div class="hidden name"><code>spillover.Rmd</code></div>

    </div>

    
    
<p>An advantage of experimental designs is that fewer assumptions are needed to justify causal claims. However, some assumptions are still needed. Perhaps the most important of these is the assumption that there are no spillovers (technically this is assumption is part of what is called the Stable Unit Treatment Value Assumption, or “SUTVA”).</p>
<p>The presence of spillovers creates a challenge for the definition of the estimand. Indeed the assumption of no spillovers runs so deep that it is often invoked even prior to the definition of estimands. If you write the “average treatment effect” estimand as <span class="math inline">\(E(Y(1) - Y(0))\)</span> you are assuming already that the potential outcomes depend only on a unit’s own assignment to treatment.</p>
<p>If there <em>are</em> spillovers however then another estimand is needed. It turns out however that in this case there may be an explosion in the set of possible estimands of interest.</p>
<p>For instance, we can define estimands such as the difference for a unit when it—and only it—is treated, compared to a situation in which no unit is treated. In potential outcomes notation that could be written, for unit 3, say, as:</p>
<p><span class="math display">\[\tau_3 = Y(0,0,1,0,0,\dots) -  Y(0,0,0,0,0,\dots)\]</span> One could then define a population estimand that is the average of all these differences over a population. Note that these differences specify different counterfactual assignment vectors for each each individual. In the absence of spillovers, this would be the same as the usual average treatment effect. But in the presence of spillovers, this estimand is well-defined, while the usual average treatment effect estimand is not.</p>
<p>But there are many other possibilities. For example, the difference in outcomes when none are treated and all are treated. Or the difference between not being treated when all others are, and all being treated. Or the difference a change in your own condition would make given that others are assigned to the value that they actually have.</p>
<p>Below we describe a design that allows for the possibility of spillovers like this. Diagnosing the design shows how severe the problem of spillovers can be for estimation. Modifying this design lets you explore different types of solutions.</p>
<div id="design-declaration" class="section level2">
<h2 class="hasAnchor">
<a href="#design-declaration" class="anchor"></a>Design Declaration</h2>
<ul>
<li>
<p><strong>M</strong>odel:</p>
<p>Our model of the world specifies a population of units each of which is a member of a group (<code>n_groups</code> of size <code>group_size</code> each). The key assumption of this spillover design is that if any member of group is treated then all units receive some equal benefit (with marginal gains possibly increasing or decreasing in the numbers treated). Specifically, letting <span class="math inline">\(G[i]\)</span> denote the group of which <span class="math inline">\(i\)</span> is a member, we assume:</p>
</li>
</ul>
<p><span class="math display">\[Y_i = \left(\frac{1}{n_{G[i]}} \sum_{j\in G[i]}Z_j \right)^\gamma + \epsilon_i\]</span></p>
<ul>
<li>
<p><strong>I</strong>nquiry:</p>
<p>The estimand of interest is the average, across all individuals, of the difference between the situation in which that individual only is treated and one in which no individuals are treated.</p>
</li>
<li>
<p><strong>D</strong>ata strategy:</p>
<p>We randomly sample half the units to treatment and half to control, not taking account of group membership. .</p>
</li>
<li>
<p><strong>A</strong>nswer strategy:</p>
<p>We subtract the mean of the control group from the mean of the treatment group in order to estimate the average treatment effect.</p>
</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N_groups</span> <span class="op">&lt;-</span> <span class="fl">80</span>
<span class="va">N_i_group</span> <span class="op">&lt;-</span> <span class="fl">3</span>
<span class="va">sd_i</span> <span class="op">&lt;-</span> <span class="fl">0.2</span>
<span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fl">2</span>

<span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_population.html">declare_population</a></span><span class="op">(</span>G <span class="op">=</span> <span class="fu">add_level</span><span class="op">(</span>N <span class="op">=</span> <span class="va">N_groups</span>, 
    n <span class="op">=</span> <span class="va">N_i_group</span><span class="op">)</span>, i <span class="op">=</span> <span class="fu">add_level</span><span class="op">(</span>N <span class="op">=</span> <span class="va">n</span>, zeros <span class="op">=</span> <span class="fl">0</span>, ones <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">dgp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span>, <span class="va">Z</span>, <span class="va">G</span>, <span class="va">n</span><span class="op">)</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Z</span><span class="op">[</span><span class="va">G</span> <span class="op">==</span> <span class="va">G</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="va">n</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="va">gamma</span> <span class="op">+</span> 
    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">sd_i</span>
<span class="va">estimand</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_inquiry.html">declare_inquiry</a></span><span class="op">(</span>Treat_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span>, 
    <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">Z_i</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="va">i</span>
        <span class="fu">dgp</span><span class="op">(</span><span class="va">i</span>, <span class="va">Z_i</span>, <span class="va">G</span>, <span class="va">n</span><span class="op">)</span> <span class="op">-</span> <span class="fu">dgp</span><span class="op">(</span><span class="va">i</span>, <span class="va">zeros</span>, <span class="va">G</span>, <span class="va">n</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span><span class="op">)</span>, label <span class="op">=</span> <span class="st">"estimand"</span><span class="op">)</span>
<span class="va">assignment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_assignment.html">declare_assignment</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">reveal_Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_reveal.html">declare_reveal</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">fabricate</span>, Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>, 
    <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu">dgp</span><span class="op">(</span><span class="va">i</span>, <span class="va">Z</span>, <span class="va">G</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">estimator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/declare_estimator.html">declare_estimator</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Z</span>, inquiry <span class="op">=</span> <span class="va">estimand</span>, 
    model <span class="op">=</span> <span class="va">lm_robust</span>, label <span class="op">=</span> <span class="st">"naive"</span><span class="op">)</span>
<span class="va">spillover_design</span> <span class="op">&lt;-</span> <span class="va">population</span> <span class="op">+</span> <span class="va">estimand</span> <span class="op">+</span> <span class="va">assignment</span> <span class="op">+</span> 
    <span class="va">reveal_Y</span> <span class="op">+</span> <span class="va">estimator</span></code></pre></div>
</div>
<div id="takeaways" class="section level2">
<h2 class="hasAnchor">
<a href="#takeaways" class="anchor"></a>Takeaways</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diagnosis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DeclareDesign/man/diagnose_design.html">diagnose_design</a></span><span class="op">(</span><span class="va">spillover_design</span>, sims <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: We recommend you choose a higher number of simulations than 25 for the
## top level of simulation.</code></pre>
<table class="table">
<colgroup>
<col width="5%">
<col width="7%">
<col width="7%">
<col width="7%">
<col width="9%">
<col width="14%">
<col width="12%">
<col width="8%">
<col width="12%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="left">Term</th>
<th align="left">Bias</th>
<th align="left">RMSE</th>
<th align="left">Power</th>
<th align="left">Coverage</th>
<th align="left">Mean Estimate</th>
<th align="left">SD Estimate</th>
<th align="left">Mean Se</th>
<th align="left">Type S Rate</th>
<th align="left">Mean Inquiry</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Z</td>
<td align="left">0.22</td>
<td align="left">0.23</td>
<td align="left">1.00</td>
<td align="left">0.00</td>
<td align="left">0.34</td>
<td align="left">0.07</td>
<td align="left">0.04</td>
<td align="left">0.00</td>
<td align="left">0.11</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">(0.02)</td>
<td align="left">(0.01)</td>
<td align="left">(0.00)</td>
<td align="left">(0.00)</td>
<td align="left">(0.02)</td>
<td align="left">(0.01)</td>
<td align="left">(0.00)</td>
<td align="left">(0.00)</td>
<td align="left">(0.00)</td>
</tr>
</tbody>
</table>
<ul>
<li><p>The simplest point to note is that the estimates of effects are biased. This renders the excellent statistical power of the design somewhat meaningless.</p></li>
<li><p>The sign of the bias term is perhaps more surprising. The idea that positive spillovers produce an underestimate of effects is a familiar one. An interesting feature of the structure of spillovers in this design is that positive spillovers can produce an <em>over</em>estimate of treatment effects when spillover effects are increasing in the number of neighbors treated. The reason is that if a treated individual is more likely to be in a group with multiple treated individuals than is an untreated individual and so outcomes for <em>treated</em> units are enhanced by within group spillovers</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Graeme Blair, Jasper Cooper, Alexander Coppock, Macartan Humphreys, Clara Bicalho, Neal Fultz, Lily Medina.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
