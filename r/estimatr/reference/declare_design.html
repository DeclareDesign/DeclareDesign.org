<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Declare a design — declare_design • DeclareDesign</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Declare a design — declare_design" />
<meta property="og:description" content="Declare a design" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DeclareDesign</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.25.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/custom_functions.html">Custom functions and DeclareDesign</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/DeclareDesign/DeclareDesign/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Declare a design</h1>
    <small class="dont-index">Source: <a href='https://github.com/DeclareDesign/DeclareDesign/blob/master/R/construct_design.R'><code>R/construct_design.R</code></a></small>
    <div class="hidden name"><code>declare_design.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Declare a design</p>
    </div>

    <pre class="usage"># S3 method for dd
+(lhs, rhs)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>lhs</th>
      <td><p>A step in a research design, beginning with a function that draws the population. Steps are evaluated sequentially. With the exception of the first step, all steps must be functions that take a <code>data.frame</code> as an argument and return a <code>data.frame</code>. Typically, many steps are declared using the <code>declare_</code> functions, i.e., <code><a href='declare_population.html'>declare_population</a></code>, <code><a href='declare_population.html'>declare_population</a></code>, <code><a href='declare_sampling.html'>declare_sampling</a></code>, <code><a href='declare_potential_outcomes.html'>declare_potential_outcomes</a></code>, <code><a href='declare_estimand.html'>declare_estimand</a></code>, <code><a href='declare_assignment.html'>declare_assignment</a></code>, and <code><a href='declare_estimator.html'>declare_estimator</a></code>.</p></td>
    </tr>
    <tr>
      <th>rhs</th>
      <td><p>A second step in a research design</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list of two functions, the <code>design_function</code> and the <code>data_function</code>. The <code>design_function</code> runs the design once, i.e. draws the data and calculates any estimates and estimands defined in <code>...</code>, returned separately as two <code>data.frame</code>'s. The <code>data_function</code> runs the design once also, but only returns the final data.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Users can supply three kinds of functions to create a design:</p>
<p>1. Data generating functions. These include population, assignment, and sampling functions.</p>
<p>2. Estimand functions.</p>
<p>3. Estimator functions.</p>
<p>The location of the estimand and estimator functions in the pipeline of functions determine *when* the values of the estimand and estimator are calculated. This allows users to, for example, differentiate between a population average treatment effect and a sample average treatment effect by placing the estimand function before or after sampling.</p>
<p>Design objects declared with the + operator can be investigated with a series of post-declaration commands, such as <code><a href='draw_functions.html'>draw_data</a></code>, <code><a href='draw_functions.html'>draw_estimands</a></code>, <code><a href='draw_functions.html'>draw_estimates</a></code>, and <code><a href='diagnose_design.html'>diagnose_design</a></code>.</p>
<p>The print and summary methods for a design object return some helpful descriptions of the steps in your research design. If randomizr functions are used for any assignment or sampling steps, additional details about those steps are provided.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='va'>my_population</span> <span class='op'>&lt;-</span> <span class='fu'><a href='declare_population.html'>declare_population</a></span><span class='op'>(</span>N <span class='op'>=</span> <span class='fl'>500</span>, noise <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>N</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>my_potential_outcomes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='declare_potential_outcomes.html'>declare_potential_outcomes</a></span><span class='op'>(</span><span class='va'>Y</span> <span class='op'>~</span> <span class='va'>Z</span> <span class='op'>+</span> <span class='va'>noise</span><span class='op'>)</span>

<span class='va'>my_sampling</span> <span class='op'>&lt;-</span> <span class='fu'><a href='declare_sampling.html'>declare_sampling</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>250</span><span class='op'>)</span>

<span class='va'>my_assignment</span> <span class='op'>&lt;-</span> <span class='fu'><a href='declare_assignment.html'>declare_assignment</a></span><span class='op'>(</span>m <span class='op'>=</span> <span class='fl'>25</span><span class='op'>)</span>

<span class='va'>my_estimand</span> <span class='op'>&lt;-</span> <span class='fu'><a href='declare_estimand.html'>declare_estimand</a></span><span class='op'>(</span>ATE <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Y_Z_1</span> <span class='op'>-</span> <span class='va'>Y_Z_0</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>my_estimator</span> <span class='op'>&lt;-</span> <span class='fu'><a href='declare_estimator.html'>declare_estimator</a></span><span class='op'>(</span><span class='va'>Y</span> <span class='op'>~</span> <span class='va'>Z</span>, estimand <span class='op'>=</span> <span class='va'>my_estimand</span><span class='op'>)</span>

<span class='va'>my_mutate</span> <span class='op'>&lt;-</span> <span class='fu'><a href='declare_step.html'>declare_step</a></span><span class='op'>(</span><span class='fu'>dplyr</span><span class='fu'>::</span><span class='va'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>, noise_sq <span class='op'>=</span> <span class='va'>noise</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>

<span class='va'>my_reveal</span> <span class='op'>&lt;-</span> <span class='fu'><a href='reveal_outcomes.html'>reveal_outcomes</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>design</span> <span class='op'>&lt;-</span> <span class='va'>my_population</span> <span class='op'>+</span> <span class='va'>my_potential_outcomes</span> <span class='op'>+</span> <span class='va'>my_sampling</span> <span class='op'>+</span>
         <span class='va'>my_estimand</span> <span class='op'>+</span> <span class='va'>my_mutate</span> <span class='op'>+</span>
         <span class='va'>my_assignment</span> <span class='op'>+</span> <span class='va'>my_reveal</span> <span class='op'>+</span> <span class='va'>my_estimator</span>

<span class='va'>design</span>
</div><div class='output co'>#&gt; 
#&gt; Design Summary
#&gt; 
#&gt; Step 1 (population): declare_population(N = 500, noise = rnorm(N)) -------------
#&gt; 
#&gt; N = 500 
#&gt; 
#&gt; Added variable: ID 
#&gt;  N_missing N_unique     class
#&gt;          0      500 character
#&gt; 
#&gt; Added variable: noise 
#&gt;    min median  mean  max sd N_missing N_unique
#&gt;  -2.87  -0.06 -0.03 3.13  1         0      500
#&gt; 
#&gt; Step 2 (potential outcomes): declare_potential_outcomes(Y ~ Z + noise) ---------
#&gt; 
#&gt; Formula: Y ~ Z + noise 
#&gt; 
#&gt; Added variable: Y_Z_0 
#&gt;    min median  mean  max sd N_missing N_unique
#&gt;  -2.87  -0.06 -0.03 3.13  1         0      500
#&gt; 
#&gt; Added variable: Y_Z_1 
#&gt;    min median mean  max sd N_missing N_unique
#&gt;  -1.87   0.94 0.97 4.13  1         0      500
#&gt; 
#&gt; Step 3 (sampling): declare_sampling(n = 250) -----------------------------------
#&gt; 
#&gt; N = 250 (250 subtracted) 
#&gt; 
#&gt; Added variable: S_inclusion_prob 
#&gt;   0.5
#&gt;   250
#&gt;  1.00
#&gt; 
#&gt; Altered variable: ID 
#&gt;   Before: 
#&gt;  N_missing N_unique     class
#&gt;          0      500 character
#&gt; 
#&gt;   After:
#&gt;  N_missing N_unique     class
#&gt;          0      250 character
#&gt; 
#&gt; Altered variable: noise 
#&gt;   Before: 
#&gt;    min median  mean  max sd N_missing N_unique
#&gt;  -2.87  -0.06 -0.03 3.13  1         0      500
#&gt; 
#&gt;   After:
#&gt;    min median mean  max   sd N_missing N_unique
#&gt;  -2.87  -0.04    0 3.13 1.03         0      250
#&gt; 
#&gt; Altered variable: Y_Z_0 
#&gt;   Before: 
#&gt;    min median  mean  max sd N_missing N_unique
#&gt;  -2.87  -0.06 -0.03 3.13  1         0      500
#&gt; 
#&gt;   After:
#&gt;    min median mean  max   sd N_missing N_unique
#&gt;  -2.87  -0.04    0 3.13 1.03         0      250
#&gt; 
#&gt; Altered variable: Y_Z_1 
#&gt;   Before: 
#&gt;    min median mean  max sd N_missing N_unique
#&gt;  -1.87   0.94 0.97 4.13  1         0      500
#&gt; 
#&gt;   After:
#&gt;    min median mean  max   sd N_missing N_unique
#&gt;  -1.87   0.96    1 4.13 1.03         0      250
#&gt; 
#&gt; Step 4 (estimand): declare_estimand(ATE = mean(Y_Z_1 - Y_Z_0)) -----------------
#&gt; 
#&gt; A single draw of the estimand:
#&gt;  estimand_label estimand
#&gt;             ATE        1
#&gt; 
#&gt; Step 5 (custom): declare_step(dplyr::mutate, noise_sq = noise^2) ---------------
#&gt; 
#&gt; Added variable: noise_sq 
#&gt;  min median mean max   sd N_missing N_unique
#&gt;    0   0.58 1.06 9.8 1.37         0      250
#&gt; 
#&gt; Step 6 (assignment): declare_assignment(m = 25) --------------------------------
#&gt; 
#&gt; Added variable: Z 
#&gt;     0    1
#&gt;   225   25
#&gt;  0.90 0.10
#&gt; 
#&gt; Added variable: Z_cond_prob 
#&gt;   0.1  0.9
#&gt;    25  225
#&gt;  0.10 0.90
#&gt; 
#&gt; Step 7 (reveal): reveal_outcomes() ---------------------------------------------
#&gt; 
#&gt; Added variable: Y 
#&gt;    min median mean  max   sd N_missing N_unique
#&gt;  -2.87   0.09  0.1 3.13 1.08         0      250
#&gt; 
#&gt; Step 8 (estimator): declare_estimator(Y ~ Z, estimand = my_estimand) -----------
#&gt; 
#&gt; Formula: Y ~ Z 
#&gt; 
#&gt; A single draw of the estimator:
#&gt;  estimator_label term estimate std.error statistic      p.value  conf.low
#&gt;        estimator    Z 1.080911 0.1998636  5.408245 6.629594e-06 0.6733124
#&gt;  conf.high       df outcome estimand_label
#&gt;    1.48851 31.04822       Y            ATE
#&gt; </div><div class='input'>
<span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='draw_functions.html'>draw_data</a></span><span class='op'>(</span><span class='va'>design</span><span class='op'>)</span>

<span class='va'>estimates</span> <span class='op'>&lt;-</span> <span class='fu'><a href='draw_functions.html'>draw_estimates</a></span><span class='op'>(</span><span class='va'>design</span><span class='op'>)</span>
<span class='va'>estimands</span> <span class='op'>&lt;-</span> <span class='fu'><a href='draw_functions.html'>draw_estimands</a></span><span class='op'>(</span><span class='va'>design</span><span class='op'>)</span>

<span class='co'># You can add steps to a design</span>

<span class='va'>design</span> <span class='op'>&lt;-</span> <span class='va'>my_population</span> <span class='op'>+</span> <span class='va'>my_potential_outcomes</span>
<span class='va'>design</span> <span class='op'>+</span> <span class='va'>my_sampling</span>
</div><div class='output co'>#&gt; 
#&gt; Design Summary
#&gt; 
#&gt; Step 1 (population): declare_population(N = 500, noise = rnorm(N)) -------------
#&gt; 
#&gt; N = 500 
#&gt; 
#&gt; Added variable: ID 
#&gt;  N_missing N_unique     class
#&gt;          0      500 character
#&gt; 
#&gt; Added variable: noise 
#&gt;    min median  mean  max   sd N_missing N_unique
#&gt;  -3.34   0.03 -0.03 3.14 1.06         0      500
#&gt; 
#&gt; Step 2 (potential outcomes): declare_potential_outcomes(Y ~ Z + noise) ---------
#&gt; 
#&gt; Formula: Y ~ Z + noise 
#&gt; 
#&gt; Added variable: Y_Z_0 
#&gt;    min median  mean  max   sd N_missing N_unique
#&gt;  -3.34   0.03 -0.03 3.14 1.06         0      500
#&gt; 
#&gt; Added variable: Y_Z_1 
#&gt;    min median mean  max   sd N_missing N_unique
#&gt;  -2.34   1.03 0.97 4.14 1.06         0      500
#&gt; 
#&gt; Step 3 (sampling): declare_sampling(n = 250) -----------------------------------
#&gt; 
#&gt; N = 250 (250 subtracted) 
#&gt; 
#&gt; Added variable: S_inclusion_prob 
#&gt;   0.5
#&gt;   250
#&gt;  1.00
#&gt; 
#&gt; Altered variable: ID 
#&gt;   Before: 
#&gt;  N_missing N_unique     class
#&gt;          0      500 character
#&gt; 
#&gt;   After:
#&gt;  N_missing N_unique     class
#&gt;          0      250 character
#&gt; 
#&gt; Altered variable: noise 
#&gt;   Before: 
#&gt;    min median  mean  max   sd N_missing N_unique
#&gt;  -3.34   0.03 -0.03 3.14 1.06         0      500
#&gt; 
#&gt;   After:
#&gt;    min median  mean  max   sd N_missing N_unique
#&gt;  -3.34  -0.01 -0.08 3.14 1.13         0      250
#&gt; 
#&gt; Altered variable: Y_Z_0 
#&gt;   Before: 
#&gt;    min median  mean  max   sd N_missing N_unique
#&gt;  -3.34   0.03 -0.03 3.14 1.06         0      500
#&gt; 
#&gt;   After:
#&gt;    min median  mean  max   sd N_missing N_unique
#&gt;  -3.34  -0.01 -0.08 3.14 1.13         0      250
#&gt; 
#&gt; Altered variable: Y_Z_1 
#&gt;   Before: 
#&gt;    min median mean  max   sd N_missing N_unique
#&gt;  -2.34   1.03 0.97 4.14 1.06         0      500
#&gt; 
#&gt;   After:
#&gt;    min median mean  max   sd N_missing N_unique
#&gt;  -2.34   0.99 0.92 4.14 1.13         0      250
#&gt; </div><div class='input'>
<span class='co'># Special Cases</span>

<span class='co'># You may wish to have a design with only one step:</span>

<span class='va'>design</span> <span class='op'>&lt;-</span> <span class='va'>my_population</span> <span class='op'>+</span> <span class='cn'>NULL</span>
<span class='va'>design</span>
</div><div class='output co'>#&gt; 
#&gt; Design Summary
#&gt; 
#&gt; Step 1 (population): declare_population(N = 500, noise = rnorm(N)) -------------
#&gt; 
#&gt; N = 500 
#&gt; 
#&gt; Added variable: ID 
#&gt;  N_missing N_unique     class
#&gt;          0      500 character
#&gt; 
#&gt; Added variable: noise 
#&gt;    min median mean max   sd N_missing N_unique
#&gt;  -3.18   0.01 0.02 3.2 0.99         0      500
#&gt; </div><div class='input'>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>diagnosis</span> <span class='op'>&lt;-</span> <span class='fu'><a href='diagnose_design.html'>diagnose_design</a></span><span class='op'>(</span><span class='va'>design</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>diagnosis</span><span class='op'>)</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Graeme Blair, Jasper Cooper, Alexander Coppock, Macartan Humphreys, Neal Fultz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


