<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.79.0" />


  <title>Getting Started with DeclareDesign - DeclareDesign</title>




  









<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css'>



<script defer src="https://use.fontawesome.com/releases/v5.5.0/js/all.js" integrity="sha384-GqVMZRt5Gn7tB9D9q7ONtcp4gtHIUEW/yG7h98J7IpE3kpi+srfFyyB/04OV6pG0" crossorigin="anonymous"></script>

<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet">

<link rel="stylesheet" href="/css/bootstrap.min.css">

<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>






  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Getting Started with DeclareDesign">
  <meta name="twitter:description" content='DeclareDesign is a system for describing research designs in code and simulating them in order to understand their properties. Because DeclareDesign employs a consistent grammar of designs, you can focus on the intellectually challenging part – designing good research studies – without having to code up simulations from scratch. DeclareDesign is based on the Model-Inquiry-Data Strategy-Answer Strategy (MIDA) framework for describing designs and a declare-diagnose-redesign workflow for improving research designs before implementing them.

'>






<script src="/js/dropdown_menu.js"></script>
<link rel="stylesheet" href="/css/custom.css">

  </head>
  <body>
    <div class="wrapper">
      
        
<header>
  <div class="navbar-wrap fixed-top bg-white">
    <nav class="navbar navbar-expand-lg navbar-light">
      <div class="container-fluid"> <a class="navbar-brand" href="/"><img src="/images/brand.svg" alt=""></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item"><a class="nav-link" href="/getting-started.html">Getting Started</a></li>
            <li class="nav-item"><a class="nav-link" href="/library.html">Library</a></li>
            <li class="nav-item dropdown">
              
              <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Software <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/r/declaredesign/">DeclareDesign</a></li>
                <li><a class="dropdown-item" href="/r/randomizr/">randomizr</a></li>
                <li><a class="dropdown-item" href="/r/fabricatr/">fabricatr</a></li>
                <li><a class="dropdown-item" href="/r/estimatr/">estimatr</a></li>
                <li><a class="dropdown-item" href="/r/designlibrary/">DesignLibrary</a></li>
              </ul>
            </li>
            <li class="nav-item"><a class="nav-link" href="/blog.html">Blog</a></li>
            <li class="nav-item"><a class="nav-link" href="/about.html">About</a></li>
            <li class="nav-item"><a target="_blank" class="nav-link" href="http://discuss.declaredesign.org/">Help</a></li>
          </ul>
        </div>
      </div>
    </nav>
  </div>
</header>

 

      


<main class="container">
  <div class="row justify-content-between">
    <div class="col-lg-8" id="content_column">
      <article class="article">
        

        <h1 class="article-title">Getting Started with DeclareDesign</h1>

        

        <div class="article-content">
          
<link href="/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>
<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>
<link href="/rmarkdown-libs/lightable/lightable.css" rel="stylesheet" />

<div id="TOC">
<ul>
<li><a href="#installing-r">Installing R</a></li>
<li><a href="#where-we-are-going">Where we are going</a></li>
<li><a href="#building-a-step-of-a-research-design">Building a step of a research design</a></li>
<li><a href="#declaring-each-step-of-a-research-design">Declaring each step of a research design</a></li>
<li><a href="#combining-steps-to-form-a-design">Combining steps to form a design</a></li>
<li><a href="#simulating-a-research-design">Simulating a research design</a></li>
<li><a href="#diagnosing-a-research-design">Diagnosing a research design</a></li>
<li><a href="#comparing-designs">Comparing designs</a></li>
</ul>
</div>

<p>DeclareDesign is a system for describing research designs in code and simulating them in order to understand their properties. Because DeclareDesign employs a consistent grammar of designs, you can focus on the intellectually challenging part – designing good research studies – without having to code up simulations from scratch. DeclareDesign is based on the Model-Inquiry-Data Strategy-Answer Strategy (MIDA) framework for describing designs and a declare-diagnose-redesign workflow for improving research designs before implementing them.</p>
<p>You can find a few different entry points into these ideas and the software tools:</p>
<ul>
<li>Short introduction to the <a href="/mida/">MIDA framework</a></li>
<li>Short introduction to DeclareDesign on the <a href="https://blogs.worldbank.org/impactevaluations/declaring-and-diagnosing-research-designs">World Bank Development Impact blog</a></li>
<li>Our paper in the <a href="/declare.pdf"><em>American Political Science Review</em></a> (<a href="/declare_SI.pdf">appendices</a>)</li>
<li><a href="/library">Library of research designs</a>, which includes a range of canonical designs that can be declared with a single line of code and then tailored for your own uses</li>
<li><a href="/blog/">Blog</a> series that demonstrates how DeclareDesign can be used to shed light on a range of tricky design choices, which includes declarations of many designs</li>
</ul>
<p>In this guide, we introduce you to <code>DeclareDesign</code> for R and how each step of the design-diagnose-redesign process can be implemented in it.</p>
<div id="installing-r" class="section level1">
<h1>Installing R</h1>
<p>To get started, install the statistical computing environment R, which you can download for free from <a href="https://cran.r-project.org">CRAN</a>. We also recommend the free program <a href="https://www.rstudio.com/products/rstudio/download">RStudio</a>, which provides a friendly interface to R.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>Once you’ve got RStudio installed, open it up and install <code>DeclareDesign</code> and its related packages. These include three packages that enable specific steps in the research process (<code>fabricatr</code> for simulating social science data; <code>randomizr</code>, for random sampling and random assignment; and <code>estimatr</code> for design-based estimators). You can also install <code>DesignLibrary</code>, which gets standard designs up-and-running in one line. To install them, you can type:</p>
<pre class="r"><code>install.packages(c(&quot;DeclareDesign&quot;, &quot;fabricatr&quot;, &quot;randomizr&quot;, &quot;estimatr&quot;, &quot;DesignLibrary&quot;))</code></pre>
<p>We also recommend you install and get to know the <code>tidyverse</code> suite of packages for data analysis, which we will use in this guide:</p>
<pre class="r"><code>install.packages(&quot;tidyverse&quot;)</code></pre>
<p>In this guide, we will introduce the <code>DeclareDesign</code> software and how to implement the MIDA framework within it. We will not provide a general introduction to R or to the <code>tidyverse</code>, because there are already many terrific introductions. We especially recommend <a href="https://r4ds.had.co.nz"><code>R for Data Science</code></a>, available for free on the Web.</p>
</div>
<div id="where-we-are-going" class="section level1">
<h1>Where we are going</h1>
<p>We will build up to declaring and diagnosing a design in this section. But to get a sense of the goal, below is a simple 100-unit randomized experiment design declared, diagnosed, and redesigned.</p>
<div id="declaring-a-design" class="section level2">
<h2>Declaring a design</h2>
<pre class="r"><code># we should turn this into a picture labeling MIDA
simple_design &lt;- 
  
  # M: model
  
  # a 100-unit population with an unobserved shock &#39;e&#39;
  declare_population(N = 100, u = rnorm(N)) +
  
  # two potential outcomes, Y_Z_0 and Y_Z_1
  # Y_Z_0 is the control potential outcome (what would happen if the unit is untreated)
  #   it is equal to the unobserved shock &#39;u&#39;
  # Y_Z_1 is the treated potential outcome 
  #   it is equal to the control potential outcome plus a treatment effect of 0.25
  declare_potential_outcomes(Y_Z_0 = u, Y_Z_1 = Y_Z_0 + 0.25) +
  
  # I: inquiry
  
  # we are interested in the average treatment effect in the population (PATE)
  declare_estimand(PATE = mean(Y_Z_1 - Y_Z_0)) +
  
  # D: data strategy
  
  # sampling: we randomly sample 50 of the 100 units in the population
  declare_sampling(n = 50) +
  
  # assignment: we randomly assign half of the 50 sampled units to treatment (half to control)
  declare_assignment(prob = 0.5) +
  
  # reveal outcomes: construct outcomes from the potential outcomes named Y depending on 
  #   the realized value of their assignment variable named Z
  declare_reveal(outcome_variables = Y, assignment_variables = Z) +
  
  # A: answer strategy
  
  # calculate the difference-in-means of Y depending on Z 
  # we link this estimator to PATE because this is our estimate of our inquiry
  declare_estimator(Y ~ Z, model = difference_in_means, estimand = &quot;PATE&quot;)</code></pre>
</div>
<div id="diagnosis" class="section level2">
<h2>Diagnosis</h2>
<p>To diagnose the design, we first define a set of diagnosands, which are statistical properties of the design. In this case, we select the bias (difference between the estimate and the estimand, which is the PATE); the root mean-squared error; and the statistical power of the design.</p>
<pre class="r"><code># Select diagnosands
simple_design_diagnosands &lt;- 
  declare_diagnosands(bias = mean(estimate - estimand), power = mean(p.value &lt;= 0.05), rmse = sqrt(mean((estimate - estimand)^2)))</code></pre>
<p>We then diagnose the design, which involves simulating the design and again and again, and then calculate the diagnosands based on the simulations data.</p>
<pre class="r"><code># Diagnose the design
simple_design_diagnosis &lt;- 
  diagnose_design(simple_design, diagnosands = simple_design_diagnosands, sims = 500)</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
estimand_label
</th>
<th style="text-align:left;">
estimator_label
</th>
<th style="text-align:right;">
bias
</th>
<th style="text-align:right;">
rmse
</th>
<th style="text-align:right;">
power
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PATE
</td>
<td style="text-align:left;">
estimator
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.15
</td>
</tr>
</tbody>
</table>
</div>
<div id="redesign" class="section level2">
<h2>Redesign</h2>
<p>We see that the power of the design is small, so we increase the number of sampled units from 50 to 100. <code>replace_step</code> creates a new design, swapping out the fourth step (sampling) for a modified sampling step.</p>
<pre class="r"><code>redesigned_simple_design &lt;-
  replace_step(simple_design, 
               step = 4, 
               new_step = declare_sampling(n = 100))</code></pre>
<p>With the big picture of the declaration, diagnosis, and redesign of a simple design in mind, we now turn to building up from a single step to a full declared design.</p>
</div>
</div>
<div id="building-a-step-of-a-research-design" class="section level1">
<h1>Building a step of a research design</h1>
<p>We begin learning about how to build a research design in <code>DeclareDesign</code> by declaring a single step: random assignment. We take as a starting point a fixed set of data, describing a set of voters in Los Angeles. The research project we are planning involves randomly assigning voters to receive a knock on their door from a canvasser (or not to receive a door knock). Our data look like this:</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
sex
</th>
<th style="text-align:left;">
party
</th>
<th style="text-align:right;">
precinct
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
DEM
</td>
<td style="text-align:right;">
5210
</td>
</tr>
<tr>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
2155
</td>
</tr>
<tr>
<td style="text-align:left;">
003
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
4321
</td>
</tr>
<tr>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
3590
</td>
</tr>
<tr>
<td style="text-align:left;">
005
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
5297
</td>
</tr>
<tr>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
GRN
</td>
<td style="text-align:right;">
8905
</td>
</tr>
</tbody>
</table>
<p>There are 100 voters in the dataset.</p>
<div id="using-dplyr" class="section level2">
<h2>Using dplyr</h2>
<p>We plan to randomly assign 50 of the voters to treatment (door knock) and 50 to control (no door knock). We want to create an indicator variable <code>Z</code>, where <code>1</code> represents treatment and <code>0</code> control. In order to do this, we use R’s <code>sample</code> function:</p>
<pre class="r"><code>voter_file &lt;- voter_file %&gt;% 
  mutate(Z = sample(c(0, 1), size = 100, replace = TRUE, prob = c(0.5, 0.5)))</code></pre>
<p>This says: draw a random sample with replacement 100 times (the number of voters) of <code>0</code>’s and <code>1</code>’s with probability <code>0.5</code> each. Recall that the <code>%&gt;%</code> operator sends a data frame to the <code>dplyr</code> verb <code>mutate</code>, which can add new columns to a data frame. This is a short <code>dplyr</code> “pipeline”.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p>Now our data frame <code>voter_file</code> includes the <code>Z</code> indicator:</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
sex
</th>
<th style="text-align:left;">
party
</th>
<th style="text-align:right;">
precinct
</th>
<th style="text-align:right;">
Z
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
DEM
</td>
<td style="text-align:right;">
5210
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
2155
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
003
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
4321
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
3590
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
005
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
5297
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
GRN
</td>
<td style="text-align:right;">
8905
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>We can make things a bit easier with the <code>randomizr</code> package, which includes common random assignment functions including simple random assignment used here. You can instead write:</p>
<pre class="r"><code>voter_file &lt;- voter_file %&gt;% 
  mutate(Z = simple_ra(N = 100, prob = 0.5))</code></pre>
<p>We might use this <code>dplyr</code> pipeline to actually implement the random assignment for a study. But to diagnose the properties of a research design, we want to know what would happen under <em>any</em> possible random assignment. To do this, we will need to run the assignment step over and over again and save the results.</p>
</div>
<div id="as-a-function" class="section level2">
<h2>As a function</h2>
<p>To simulate the design in order to diagnose it, we need to turn the assignment step into a <em>function</em>. The function can then be run again and again, each time resulting in a different random assignment.</p>
<p>In <code>DeclareDesign</code>, we are going to use a special kind of function: a <em>tidy</em> function, which takes <em>in</em> a data frame and returns back <em>out</em> a data frame. The new data frame may have an additional variable (such as a random assignment) or it may have fewer rows (due to sampling, for example).</p>
<p>For our random assignment step, we want to create a tidy function that adds our assignment indicator <code>Z</code> to the data, but leaves it otherwise unchanged. We write:</p>
<pre class="r"><code>simple_random_assignment_function &lt;- function(data) {
  data %&gt;% mutate(Z = simple_ra(N = 100, prob = 0.5))
}</code></pre>
<p>We took the <code>dplyr</code> pipeline we built above, and put it on the inside of a tidy function. Now, when we run our random assignment function on the voter file, it adds in <code>Z</code>:</p>
<pre class="r"><code>simple_random_assignment_function(voter_file) </code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
sex
</th>
<th style="text-align:left;">
party
</th>
<th style="text-align:right;">
precinct
</th>
<th style="text-align:right;">
Z
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
DEM
</td>
<td style="text-align:right;">
5210
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
2155
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
003
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
4321
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
3590
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
005
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
5297
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
GRN
</td>
<td style="text-align:right;">
8905
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div id="in-declaredesign" class="section level2">
<h2>In DeclareDesign</h2>
<p><code>DeclareDesign</code> makes writing each design step just a bit easier. Instead of writing a function each time, it writes a function for us. The core of <code>DeclareDesign</code> is a set of <code>declare_*</code> functions, including <code>declare_assignment</code>. Each one is a <em>function factory</em>, meaning it takes a set of parameters about your research design like the number of units and the random assignment probability as <em>inputs</em>, and returns a <em>function</em> as an output.
Instead of writing the function <code>simple_random_assignment_function</code> as we did above, in <code>DeclareDesign</code> we <em>declare</em> it:</p>
<pre class="r"><code>simple_random_assignment_step &lt;- declare_assignment(prob = 0.5)</code></pre>
<p><code>simple_random_assignment_step</code> is a tidy function. You can run the function on data:</p>
<pre class="r"><code>simple_random_assignment_step(voter_file) </code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
sex
</th>
<th style="text-align:left;">
party
</th>
<th style="text-align:right;">
precinct
</th>
<th style="text-align:right;">
Z
</th>
<th style="text-align:right;">
Z_cond_prob
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
DEM
</td>
<td style="text-align:right;">
5210
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
2155
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
003
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
4321
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
3590
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
005
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
5297
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
GRN
</td>
<td style="text-align:right;">
8905
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
</tbody>
</table>
<p>A few parts of the declaration may seem a little bit odd. First, we did not tell R anything about the number of units in our dataset, as we did in the function and in the <code>dplyr</code> pipeline we wrote earlier. Second, we didn’t give it the data! This is because a step declaration creates a function that will work on any size dataset. We told <code>declare_assignment</code> that we want to assign treatment with probability <code>0.5</code> (and implicitly control with probability <code>1-0.5 = 0.5</code>), regardless of how large the dataset is. We did not send the declaration the data, because <code>declare_assignment</code> automatically creates a tidy function for us, one that takes data and returns data with an assignment step. We will see in a moment how <code>DeclareDesign</code> uses these functions to simulate data from a research design. But you can always use the function yourself with your own data.</p>
<p>Every step of a research design in MIDA can be written using one of the <code>declare_*</code> functions. In the next section, we walk through each step and how to declare it using <code>DeclareDesign</code>.</p>
</div>
</div>
<div id="declaring-each-step-of-a-research-design" class="section level1">
<h1>Declaring each step of a research design</h1>
<p>In this section, we walk through how to declare each step of a research design using <code>DeclareDesign</code>. In the next section, we build those steps into a research design, and then describe how to interrogate the design.</p>
<div id="model" class="section level2">
<h2>Model</h2>
<p>The model defines the structure of the world, both its size and background characteristics as well as how interventions in the world determine outcomes. In <code>DeclareDesign</code>, we split the model into two main design steps: the population and potential outcomes. There is always one population in a design, but there can be multiple sets of potential outcomes.</p>
<div id="population" class="section level3">
<h3>Population</h3>
<p>The population defines the number of units in the population, any multilevel structure to the data, and its background characteristics. We can define the population in several ways.</p>
<p>In some cases, you may start a design with data on the population. When that happens, we do not to simulate it. We can simply declare the data as our population:</p>
<pre class="r"><code>declare_population(data = voter_file)</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
sex
</th>
<th style="text-align:left;">
party
</th>
<th style="text-align:right;">
precinct
</th>
<th style="text-align:right;">
Z
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
DEM
</td>
<td style="text-align:right;">
5210
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
2155
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
003
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
4321
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
3590
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
005
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
5297
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
GRN
</td>
<td style="text-align:right;">
8905
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>When we do not have complete data on the population, we simulate it. Relying on the data simulation functions from our <code>fabricatr</code> package, <code>declare_population</code> asks about the size and variables of the population:</p>
<pre class="r"><code>declare_population(N = 100, u = rnorm(N))</code></pre>
<p>When we run the declared population function, we will get a different 100-unit dataset each time:</p>
<table class="kable_wrapper table" style="margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
u
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
-1.10
</td>
</tr>
<tr>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
-0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
003
</td>
<td style="text-align:right;">
-0.35
</td>
</tr>
<tr>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
0.53
</td>
</tr>
<tr>
<td style="text-align:left;">
005
</td>
<td style="text-align:right;">
1.61
</td>
</tr>
<tr>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
0.51
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
u
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
1.44
</td>
</tr>
<tr>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
1.36
</td>
</tr>
<tr>
<td style="text-align:left;">
003
</td>
<td style="text-align:right;">
0.33
</td>
</tr>
<tr>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
1.43
</td>
</tr>
<tr>
<td style="text-align:left;">
005
</td>
<td style="text-align:right;">
-0.87
</td>
</tr>
<tr>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
0.95
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
u
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
-0.45
</td>
</tr>
<tr>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
0.80
</td>
</tr>
<tr>
<td style="text-align:left;">
003
</td>
<td style="text-align:right;">
-0.57
</td>
</tr>
<tr>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
-1.93
</td>
</tr>
<tr>
<td style="text-align:left;">
005
</td>
<td style="text-align:right;">
0.66
</td>
</tr>
<tr>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
-1.60
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>The <code>fabricatr</code> package can simulate data for social science research including multilevel data structures like students in classrooms in schools. You can read the <code>fabricatr</code> <a href="https://declaredesign.org/r/fabricatr">Web site</a> to get started simulating your data structure. A simple two-level data structure of individuals within households could be declared as:</p>
<pre class="r"><code>declare_population(
  households = add_level(N = 100, individuals_per_hh = sample(1:10, N, replace = TRUE)),
  individuals = add_level(N = individuals_per_hh, age = sample(1:100, N, replace = TRUE))
)</code></pre>
<p>In every step of the research design process, you can short-circuit our default way of doing things and bring in your own code. This is useful when you have a complex design, or when you’ve already written code for your design and you want to use it directly. It works by setting the handler:</p>
<pre class="r"><code>complex_population_function &lt;- function(data, N_units) {
  data.frame(u = rnorm(N_units))
}

declare_population(handler = complex_population_function, N_units = 100)</code></pre>
</div>
<div id="potential-outcomes" class="section level3">
<h3>Potential outcomes</h3>
<p>Defining potential outcomes is as easy as a single expression per potential outcome. These may be a function of background characteristics, other potential outcomes, or other R functions.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<pre class="r"><code>declare_potential_outcomes(
  Y_Z_0 = u, 
  Y_Z_1 = Y_Z_0 + 0.25)</code></pre>
<pre class="r"><code>des &lt;- declare_population(N = 100, u = rnorm(N)) +
  declare_potential_outcomes(Y_Z_0 = u, Y_Z_1 = Y_Z_0 + 0.25)

draw_data(des)</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
u
</th>
<th style="text-align:right;">
Y_Z_0
</th>
<th style="text-align:right;">
Y_Z_1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
-0.92
</td>
<td style="text-align:right;">
-0.92
</td>
<td style="text-align:right;">
-0.67
</td>
</tr>
<tr>
<td style="text-align:left;">
003
</td>
<td style="text-align:right;">
1.71
</td>
<td style="text-align:right;">
1.71
</td>
<td style="text-align:right;">
1.96
</td>
</tr>
<tr>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
-1.17
</td>
<td style="text-align:right;">
-1.17
</td>
<td style="text-align:right;">
-0.92
</td>
</tr>
<tr>
<td style="text-align:left;">
005
</td>
<td style="text-align:right;">
-1.78
</td>
<td style="text-align:right;">
-1.78
</td>
<td style="text-align:right;">
-1.53
</td>
</tr>
<tr>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
-2.25
</td>
<td style="text-align:right;">
-2.25
</td>
<td style="text-align:right;">
-2.00
</td>
</tr>
</tbody>
</table>
<p>We also have a simpler interface to define all the potential outcomes at once as a function of a treatment assignment variable. The names of the potential outcomes are constructed from the outcome name (here <code>Y</code> on the lefthand side of the formula) and from the <code>assignment_variables</code> argument (here <code>Z</code>).</p>
<pre class="r"><code>declare_potential_outcomes(Y ~ u + 0.25 * Z, assignment_variables = Z)</code></pre>
<p>Either way of creating potential outcomes works; one may be easier or harder to code up in a given research design setting.</p>
</div>
</div>
<div id="inquiry" class="section level2">
<h2>Inquiry</h2>
<p>To define your inquiry, declare your estimand, which is a function of background characteristics from your population, potential outcomes, or both. We define the average treatment effect for the experiment in our simple design as follows:</p>
<pre class="r"><code>declare_estimand(PATE = mean(Y_Z_1 - Y_Z_0))</code></pre>
<p>Notice that we defined the PATE (the <em>population</em> average treatment effect), but said nothing special related to the population. In fact, it looks like we just defined the average treatment effect. This is because where you define the estimand in your design is going to determine whether it refers to the population, sample, or other form of estimand. We will see how to do this in a moment.</p>
</div>
<div id="data-strategy" class="section level2">
<h2>Data strategy</h2>
<p>The data strategy constitutes one or more steps representing interventions the researcher makes in the world from sampling to assignment to measurement. Typically, this may include sampling and assignment.</p>
<div id="sampling" class="section level3">
<h3>Sampling</h3>
<p>The sampling step relies on the <code>randomizr</code> package to conduct random sampling. We define a simple 50-unit sample from the population as follows:</p>
<pre class="r"><code>declare_sampling(n = 50)</code></pre>
<p>When we draw data from our simple design at this point, it will be smaller: from 100 units in the population to a data frame of 50 units representing the sample. In the data frame, we have an inclusion probability, the probability of being included in the sample. <code>randomizr</code> includes this by default. In this case, every unit in the population had an equal 0.5 probability of inclusion.</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
u
</th>
<th style="text-align:right;">
Y_Z_0
</th>
<th style="text-align:right;">
Y_Z_1
</th>
<th style="text-align:right;">
S_inclusion_prob
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
-0.67
</td>
<td style="text-align:right;">
-0.67
</td>
<td style="text-align:right;">
-0.42
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
003
</td>
<td style="text-align:right;">
-1.11
</td>
<td style="text-align:right;">
-1.11
</td>
<td style="text-align:right;">
-0.86
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
-0.34
</td>
<td style="text-align:right;">
-0.34
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
-1.23
</td>
<td style="text-align:right;">
-1.23
</td>
<td style="text-align:right;">
-0.98
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
008
</td>
<td style="text-align:right;">
-1.25
</td>
<td style="text-align:right;">
-1.25
</td>
<td style="text-align:right;">
-1.00
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
010
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
</tbody>
</table>
<p>Sampling could also be non-random, which could be accomplished by using a handler.</p>
</div>
<div id="assignment" class="section level3">
<h3>Assignment</h3>
<p>Assignment also relies, by default, on the <code>randomizr</code> package for random assignment. Here, we define assignment as a 50% probability of assignment to treatment and 50% to control.</p>
<pre class="r"><code>declare_assignment(prob = 0.5)</code></pre>
<p>Assignment results in a data frame with an additional indicator <code>Z</code> of the assignment as well as the probability of assignment. Again, here the assignment probabilities are constant, but in other designs they are not and this is crucial information for the analysis stage.</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
u
</th>
<th style="text-align:right;">
Y_Z_0
</th>
<th style="text-align:right;">
Y_Z_1
</th>
<th style="text-align:right;">
S_inclusion_prob
</th>
<th style="text-align:right;">
Z
</th>
<th style="text-align:right;">
Z_cond_prob
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
-0.77
</td>
<td style="text-align:right;">
-0.77
</td>
<td style="text-align:right;">
-0.52
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
-1.55
</td>
<td style="text-align:right;">
-1.55
</td>
<td style="text-align:right;">
-1.30
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
003
</td>
<td style="text-align:right;">
-1.29
</td>
<td style="text-align:right;">
-1.29
</td>
<td style="text-align:right;">
-1.04
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
-1.17
</td>
<td style="text-align:right;">
-1.17
</td>
<td style="text-align:right;">
-0.92
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
009
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
</tbody>
</table>
</div>
<div id="other-data-strategies" class="section level3">
<h3>Other data strategies</h3>
<p>Random sampling and random assignment are not the only kinds of data strategies. Others may include merging in fixed administrative data from other sources, collapsing data across months or days, and other operations. You can include these as steps in your design too, using <code>declare_step</code>. Here, you must define a handler, as we did for using a custom function in <code>declare_population</code>. Some handlers that may prove useful are the <code>dplyr</code> verbs such as <code>mutate</code> and <code>summarize</code>, and the <code>fabricate</code> function from our <code>fabricatr</code> package.</p>
<p>To add a variable using fabricate:</p>
<pre class="r"><code>declare_step(handler = fabricate, add_variable = rnorm(N))</code></pre>
<p>If you have district-month data you may want to analyze at the district level, collapsing across months:<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<pre class="r"><code>collapse_data &lt;- function(data, collapse_by) {
  data %&gt;% group_by({{ collapse_by }}) %&gt;% summarize_all(mean, na.rm = TRUE)
}

declare_step(handler = collapse_data, collapse_by = district)</code></pre>
</div>
</div>
<div id="answer-strategy" class="section level2">
<h2>Answer strategy</h2>
<p>Through our model and data strategy steps, we have simulated a dataset with two key inputs to the answer strategy: an assignment variable and an outcome. In other answer strategies, pretreatment characteristics from the model might also be relevant. The data look like this:</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
u
</th>
<th style="text-align:right;">
Y_Z_0
</th>
<th style="text-align:right;">
Y_Z_1
</th>
<th style="text-align:right;">
S_inclusion_prob
</th>
<th style="text-align:right;">
Z
</th>
<th style="text-align:right;">
Z_cond_prob
</th>
<th style="text-align:right;">
Y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
-0.12
</td>
</tr>
<tr>
<td style="text-align:left;">
005
</td>
<td style="text-align:right;">
-1.51
</td>
<td style="text-align:right;">
-1.51
</td>
<td style="text-align:right;">
-1.26
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
-1.26
</td>
</tr>
<tr>
<td style="text-align:left;">
007
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
0.77
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.52
</td>
</tr>
<tr>
<td style="text-align:left;">
008
</td>
<td style="text-align:right;">
1.33
</td>
<td style="text-align:right;">
1.33
</td>
<td style="text-align:right;">
1.58
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1.58
</td>
</tr>
<tr>
<td style="text-align:left;">
010
</td>
<td style="text-align:right;">
1.60
</td>
<td style="text-align:right;">
1.60
</td>
<td style="text-align:right;">
1.85
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1.85
</td>
</tr>
<tr>
<td style="text-align:left;">
012
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.20
</td>
</tr>
</tbody>
</table>
<p>Our estimator is the difference-in-means estimator, which compares outcomes between the group that was assigned to treatment and that assigned to control. We can calculate the difference-in-means estimate with a call to <code>summarize</code> from <code>dplyr</code>:</p>
<pre class="r"><code>simple_design_data %&gt;% summarize(DiM = mean(Y[Z == 1]) - mean(Y[Z == 0]))</code></pre>
<table>
<thead>
<tr>
<th style="text-align:right;">
DiM
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.51
</td>
</tr>
</tbody>
</table>
<p>The <code>estimatr</code> package makes this easy and calculates the design-based standard error and a p-value and confidence interval for you:</p>
<pre class="r"><code>difference_in_means(Y ~ Z, data = simple_design_data)</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:left;">
outcome
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Z
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
1.9
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
1.1
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:left;">
Y
</td>
</tr>
</tbody>
</table>
<p>Now, in order to <em>declare</em> our estimator, we can send the name of a model to <code>declare_estimator</code>. R has many models that work with <code>declare_estimator</code>, including <code>lm</code>, <code>glm</code>, the <code>ictreg</code> package from the <code>list</code> package, etc. The design-based estimators from <code>estimatr</code> can all be used.</p>
<pre class="r"><code>declare_estimator(Y ~ Z, model = difference_in_means, estimand = &quot;PATE&quot;)</code></pre>
<p>In this declaration, we also define the estimand we are targeting with the difference-in-means estimator.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> Typically, you will have an estimand that you are targeting, and sometimes you may consider targeting more than one and assessing how good your estimator estimates them. For example, you may want to know how good a job your instrumental variables job is at targeting the complier average causal effect, but also how close it gets on average to the average treatment effect.</p>
</div>
</div>
<div id="combining-steps-to-form-a-design" class="section level1">
<h1>Combining steps to form a design</h1>
<p>In the last section, we defined a set of individual research steps. We draw one version of them together here:</p>
<pre class="r"><code>population &lt;- declare_population(N = 100, u = rnorm(N)) 
potential_outcomes &lt;- declare_potential_outcomes(Y_Z_0 = u, Y_Z_1 = Y_Z_0 + 0.25) 
estimand &lt;- declare_estimand(PATE = mean(Y_Z_1 - Y_Z_0)) 
sampling &lt;- declare_sampling(n = 50) 
assignment &lt;- declare_assignment(prob = 0.5) 
reveal &lt;- declare_reveal(outcome_variables = Y, assignment_variables = Z) 
estimator &lt;- declare_estimator(Y ~ Z, model = difference_in_means, estimand = &quot;PATE&quot;)</code></pre>
<p>To construct a research design <em>object</em> that we can operate on — diagnose it, redesign it, draw data from it, etc. — we add them together with the <code>+</code> operator. The <code>+</code> creates a design object.</p>
<pre class="r"><code>simple_design &lt;- 
  population + potential_outcomes + estimand + sampling + assignment + reveal + estimator</code></pre>
<p>Often we’ll use a more compact way of writing a design, where we define it all at once with the <code>+</code>:</p>
<pre class="r"><code>simple_design &lt;- 
  declare_population(N = 100, u = rnorm(N)) +
  declare_potential_outcomes(Y_Z_0 = u, Y_Z_1 = Y_Z_0 + 0.25) +
  declare_estimand(PATE = mean(Y_Z_1 - Y_Z_0)) +
  declare_sampling(n = 50) +
  declare_assignment(prob = 0.5) +
  declare_reveal(outcome_variables = Y, assignment_variables = Z) +
  declare_estimator(Y ~ Z, model = difference_in_means, estimand = &quot;PATE&quot;)</code></pre>
<div id="order-matters" class="section level2">
<h2>Order matters</h2>
<p>When defining a design, the order steps are included in the design via the <code>+</code> operator matters. Think of the order of your design as the causal order in which steps take place.</p>
<pre class="r"><code>population + potential_outcomes + estimand + sampling + assignment + reveal + estimator</code></pre>
<p>The order encodes several important aspects of the design:</p>
<ul>
<li>First, the fact that the estimand follows the potential outcomes and comes before sampling and assignment means it is a <em>population</em> estimand, the population average treatment effect. This is because it is calculated on the data created <em>so far</em>.</li>
<li>The estimator comes after the assignment and reveal outcomes steps. If it didn’t, our difference-in-means would not work, because it wouldn’t have access to the treatment variable and the realized outcomes.</li>
</ul>
</div>
</div>
<div id="simulating-a-research-design" class="section level1">
<h1>Simulating a research design</h1>
<p>Diagnosing a research design — learning about its properties — requires first simulating running the design over and over. We need to simulate the data generating process, then calculate the estimands, then calculate the estimates that will result.</p>
<div id="in-dplyr" class="section level2">
<h2>In <code>dplyr</code></h2>
<p>We first demonstrate how to use the tidy functions created by the <code>declare_*</code> functions in a <code>dplyr</code> pipeline to simulate a design once.</p>
<p>We can run the population function, which generates the data structure, and then add the potential outcomes, and calculate the estimand as follows:</p>
<pre class="r"><code>population() %&gt;% potential_outcomes %&gt;% estimand</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
estimand_label
</th>
<th style="text-align:right;">
estimand
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PATE
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
</tbody>
</table>
<p>This is the same thing as running the functions one at a time on each other: <code>estimand(potential_outcomes(population()))</code>.</p>
<p>Similarly, if we want to draw simulated estimates from the design, we again simulate a population, add potential outcomes, but now sample units, assign treatments to sampled units, reveal the outcomes, and calculate estimates:</p>
<pre class="r"><code>population() %&gt;% potential_outcomes %&gt;% sampling %&gt;%  assignment %&gt;% reveal %&gt;% estimator</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
estimator_label
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:left;">
outcome
</th>
<th style="text-align:left;">
estimand_label
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
estimator
</td>
<td style="text-align:left;">
Z
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
-0.18
</td>
<td style="text-align:right;">
0.86
</td>
<td style="text-align:right;">
-0.63
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:left;">
Y
</td>
<td style="text-align:left;">
PATE
</td>
</tr>
</tbody>
</table>
</div>
<div id="in-declaredesign-1" class="section level2">
<h2>In <code>DeclareDesign</code></h2>
<p>With simple design defined as an object, we can easily learn about what kind of data it generates, the values of its estimand and estimates, and other features with simple functions in <code>DeclareDesign</code>. They chain together functions in a similar way to the <code>dplyr</code> pipelines above.</p>
<p>To draw simulated data based on the design, we use <code>draw_data</code>:</p>
<pre class="r"><code>draw_data(simple_design)</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
u
</th>
<th style="text-align:right;">
Y_Z_0
</th>
<th style="text-align:right;">
Y_Z_1
</th>
<th style="text-align:right;">
S_inclusion_prob
</th>
<th style="text-align:right;">
Z
</th>
<th style="text-align:right;">
Z_cond_prob
</th>
<th style="text-align:right;">
Y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
003
</td>
<td style="text-align:right;">
-1.45
</td>
<td style="text-align:right;">
-1.45
</td>
<td style="text-align:right;">
-1.20
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
-1.45
</td>
</tr>
<tr>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
1.68
</td>
<td style="text-align:right;">
1.68
</td>
<td style="text-align:right;">
1.93
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1.93
</td>
</tr>
<tr>
<td style="text-align:left;">
007
</td>
<td style="text-align:right;">
-0.32
</td>
<td style="text-align:right;">
-0.32
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
-0.07
</td>
</tr>
<tr>
<td style="text-align:left;">
009
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.21
</td>
</tr>
<tr>
<td style="text-align:left;">
012
</td>
<td style="text-align:right;">
-0.57
</td>
<td style="text-align:right;">
-0.57
</td>
<td style="text-align:right;">
-0.32
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
-0.57
</td>
</tr>
</tbody>
</table>
<p><code>draw_data</code> runs all of the “data steps” in a design, which are both from the model (population and potential outcomes) and from the data strategy (typically sampling and assignment).</p>
<p>To simulate the estimands from a single run of the design, we use <code>draw_estimands</code>. This runs two operations at once: it draws the data, and calculates the estimands at the point defined by the design. For example, in our design the estimand comes just after the potential outcomes. In this design, <code>draw_estimands</code> will run the first two steps and then calculate the estimands from the <code>estimand</code> function we declared:</p>
<pre class="r"><code>draw_estimands(simple_design)</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
estimand_label
</th>
<th style="text-align:right;">
estimand
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PATE
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
</tbody>
</table>
<p>Similarly, we can simulate the estimates from a single run with <code>draw_estimates</code> which draws data and at the appropriate moment calculates estimates.</p>
<pre class="r"><code>draw_estimates(simple_design)</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
estimator_label
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:left;">
outcome
</th>
<th style="text-align:left;">
estimand_label
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
estimator
</td>
<td style="text-align:left;">
Z
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
-0.33
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:left;">
Y
</td>
<td style="text-align:left;">
PATE
</td>
</tr>
</tbody>
</table>
<p>To diagnose a design, we want a data frame that includes the estimates <em>and</em> estimands from many runs of a design. That is, we want to run the design, draw estimates and estimands, and then do that over and over and stack the results. This is exactly what <code>simulate_design</code> does:</p>
<pre class="r"><code>simulate_design(simple_design, sims = 500)</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
design_label
</th>
<th style="text-align:right;">
sim_ID
</th>
<th style="text-align:left;">
estimand_label
</th>
<th style="text-align:right;">
estimand
</th>
<th style="text-align:left;">
estimator_label
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:left;">
outcome
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
simple_design
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
PATE
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:left;">
estimator
</td>
<td style="text-align:left;">
Z
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
1.46
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
0.94
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:left;">
Y
</td>
</tr>
<tr>
<td style="text-align:left;">
simple_design
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
PATE
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:left;">
estimator
</td>
<td style="text-align:left;">
Z
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
1.88
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.84
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
Y
</td>
</tr>
<tr>
<td style="text-align:left;">
simple_design
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
PATE
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:left;">
estimator
</td>
<td style="text-align:left;">
Z
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
-0.38
</td>
<td style="text-align:right;">
0.84
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:left;">
Y
</td>
</tr>
<tr>
<td style="text-align:left;">
simple_design
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
PATE
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:left;">
estimator
</td>
<td style="text-align:left;">
Z
</td>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
1.22
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
-0.23
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:left;">
Y
</td>
</tr>
<tr>
<td style="text-align:left;">
simple_design
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
PATE
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:left;">
estimator
</td>
<td style="text-align:left;">
Z
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
-0.49
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;">
Y
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="diagnosing-a-research-design" class="section level1">
<h1>Diagnosing a research design</h1>
<p>The simulations data frame we created allows us to diagnose the design (calculate summary statistics from the simulations) directly. We can, for example, use the following <code>dplyr</code> pipeline to calculate the bias, root mean-squared error, and power for each estimator-estimand pair.</p>
<pre class="r"><code>simulations_df %&gt;% 
  group_by(estimand_label, estimator_label) %&gt;% 
  summarize(bias = mean(estimate - estimand),
            rmse = sqrt(mean((estimate - estimand)^2)),
            power = mean(p.value &lt; .05))</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
estimand_label
</th>
<th style="text-align:left;">
estimator_label
</th>
<th style="text-align:right;">
bias
</th>
<th style="text-align:right;">
rmse
</th>
<th style="text-align:right;">
power
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PATE
</td>
<td style="text-align:left;">
estimator
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>In <code>DeclareDesign</code>, we do this in two steps. First, declare your diagnosands. These are functions of the simulations data. We have precoded several standard diagnosands.</p>
<pre class="r"><code>study_diagnosands &lt;- declare_diagnosands(
  bias = mean(estimate - estimand), 
  power = mean(p.value &lt;= 0.05), 
  rmse = sqrt(mean((estimate - estimand)^2)),
  mse = mean((estimate - estimand)^2))</code></pre>
<p>Next, take your simulations data and the diagnosands, and diagnose. This runs a single operation, which is to calculate the diagnosands on your simulations data, just like in the <code>dplyr</code> version above.</p>
<pre class="r"><code>diagnose_design(simulations_df, diagnosands = study_diagnosands)</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
design_label
</th>
<th style="text-align:left;">
estimand_label
</th>
<th style="text-align:left;">
estimator_label
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
bias
</th>
<th style="text-align:right;">
se(bias)
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
se(power)
</th>
<th style="text-align:right;">
rmse
</th>
<th style="text-align:right;">
se(rmse)
</th>
<th style="text-align:right;">
mse
</th>
<th style="text-align:right;">
se(mse)
</th>
<th style="text-align:right;">
n_sims
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
simple_design
</td>
<td style="text-align:left;">
PATE
</td>
<td style="text-align:left;">
estimator
</td>
<td style="text-align:left;">
Z
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
<p>We can also do this in a single step. When you send <code>diagnose_design</code> a design object, it will first run the simulations for you, then calculate the diagnosands from the simulations data frame that results.</p>
<pre class="r"><code>diagnose_design(simple_design, diagnosands = study_diagnosands)</code></pre>
</div>
<div id="comparing-designs" class="section level1">
<h1>Comparing designs</h1>
<p>In the diagnosis phase, you will often want to compare the properties of two designs to see which you prefer on the basis of the diagnosand values. We have two ways to compare. First, we can compare the designs themselves — what kinds of estimates and estimands do they produce, what steps are in the design. And we can compare the diagnoses.</p>
<pre class="r"><code>compare_designs(simple_design, redesigned_simple_design)</code></pre>
<p>To compare the diagnoses, we run a diagnosis for each one and then calculate the difference between each diagnosand for the two designs and conduct a statistical test of the null effect of no difference.</p>
<pre class="r"><code>compare_diagnoses(simple_design, redesigned_simple_design)</code></pre>
<div id="comparing-many-variants-of-a-design" class="section level2">
<h2>Comparing many variants of a design</h2>
<p>Often, we want to compare a large set of similar designs, varying key design parameters such as sample size, effect size, or the probability of treatment assignment. The easiest way to do this is to write a function that makes designs based on a set of these design inputs. We call these <em>designers</em>. Here’s a simple designer based on our running example:</p>
<pre class="r"><code>simple_designer &lt;- function(sample_size, effect_size) {
  declare_population(N = sample_size, u = rnorm(N)) +
    declare_potential_outcomes(Y_Z_0 = u, Y_Z_1 = Y_Z_0 + effect_size) +
    declare_estimand(PATE = mean(Y_Z_1 - Y_Z_0)) +
    declare_sampling(n = 50) +
    declare_assignment(prob = 0.5) +
    declare_reveal(outcome_variables = Y, assignment_variables = Z) +
    declare_estimator(Y ~ Z, model = difference_in_means, estimand = &quot;PATE&quot;)
}</code></pre>
<p>To create a single design, based on our original parameters of a 100-unit sample size and a treatment effect of <code>0.25</code>, we can run:</p>
<pre class="r"><code>simple_design &lt;- simple_designer(sample_size = 100, effect_size = 0.25)</code></pre>
<p>Now to simulate multiple designs, we can use the <code>DeclareDesign</code> function <code>expand_design</code>. Here we examine our simple design under several possible sample sizes, which we might want to do to conduct a minimum power analysis. We hold the effect size constant.</p>
<pre class="r"><code>simple_designs &lt;- expand_design(simple_designer, sample_size = c(100, 500, 1000), effect_size = 0.25)</code></pre>
<p>Our simulation and diagnosis tools can take a set of expanded designs (an R list) and will simulate all of them at once, creating a column called <code>design_label</code> to keep them apart. For example:</p>
<pre class="r"><code>diagnose_design(simple_designs)</code></pre>
</div>
<div id="library-of-designs" class="section level2">
<h2>Library of designs</h2>
<p>In our <code>DesignLibrary</code> package, we have created a set of common designs as designers, so you can get started quickly and also easily set up a range of design variants for comparison.</p>
<pre class="r"><code>library(DesignLibrary)

b_c_design &lt;- block_cluster_two_arm_designer(N = 1000, N_blocks = 10)

diagnose_design(b_c_design)</code></pre>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Both R and RStudio are available on Windows, Mac, and Linux.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>This pipeline could be expressed in base R as <code>voter_file$Z &lt;- sample(c(0, 1), size = 100, replace = TRUE, prob = c(0.5, 0.5))</code><a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Typically, we think of potential outcomes as fixed and not random, and move random variables to the population.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>The <code>{{ }}</code> syntax is handy for writing functions in <code>dplyr</code> where you want to be able reuse the function with different variable names. Here, the <code>collapse_data</code> function will <code>group_by</code> the variable you send to the argument <code>collapse_by</code>, which in our declaration we set to <code>district</code>. The pipeline within the function then calculates the mean in each district.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Sometimes, you may be interested just in the properties of an estimator, such as calculating its power. In this case, you need not define an estimand.<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

        </div>
      </article>
      



    </div>
    







<div class="col-lg-3" id="toc_column">
  <div id="TOC" class="mb-3">
    <nav class="navbar navbar-light bg-light">
      
        <div></div> 
      
    </nav>
  </div>
</div>

  </div>
</main>

    </div>

    

<footer>
    <div class="footer-top">
      <div class="container">
        <div class="row no-gutters">
          <div class="col-lg-7 col-md-12">
            <div class="row">
              <div class="col-md-3 col-12">
                <div class="footer-brand"><a href=""><img src="/images/brand-footer.svg" alt=""></a></div>
              </div>
              <div class="col-md-3 col-4">
                <p>DeclareDesign</p>
                <ul class="list-unstyled">
                  <li><a href="/">Home</a></li>
                  <li><a href="/about.html">About</a></li>
                  <li><a href="/r/designlibrary">Library</a></li>
                  <li><a href="/blog.html">Blog</a></li>
                  <li><a href="http://discuss.declaredesign.org/">Help</a></li>
                </ul>
              </div>
              <div class="col-md-3 col-4">
                <p>Software</p>
                <ul class="list-unstyled">
                  <li><a href="/r/declaredesign/">DeclareDesign</a></li>
                  <li><a href="/r/estimatr/">estimatr</a></li>
                  <li><a href="/r/randomizr/">randomizr</a></li>
                  <li><a href="/r/fabricatr/">fabricatr</a></li>
                  <li><a href="/r/designlibrary/">DesignLibrary</a></li>
                </ul>
              </div>
              
            </div>
          </div>
          <div class="col-lg-5 col-md-12"></div>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <div class="footer-meta-block">
        <div class="container">
          <div class="row align-items-center">
            <div class="col-sm-7">
              <p class="mb-0">&copy; 2021 Graeme Blair, Jasper Cooper, Alexander Coppock, and Macartan Humphreys</p>
            </div>
            <div class="col-sm-5">
              <div class="fbl-link-wrap">
                <ul class="list-inline mb-0">
                  <li class="list-inline-item"> <a target="_blank" href="http://github.com/DeclareDesign/"><img src="images/icon-git.svg" alt=""></a> </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>
  
   
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://cdn.datatables.net/v/bs4/dt-1.10.18/datatables.min.css"/>
<script src="https://cdn.datatables.net/v/bs4/dt-1.10.18/datatables.min.js"></script>

<script>
    jQuery(function ()
    {
        const library_list = jQuery("#design_library_list");
        library_list.addClass("table table-striped table-bordered");
        library_list.DataTable(
            {
                "autoWidth": false,
                "columns":
                    [
                        {"width": "30%"}, 
                        {"width": "10%"}, 
                        {"width": "10%"}, 
                        {"width": "10%"}, 
                        {"width": "15%"}, 
                        {"width": "25%"}, 
                    ],
                "drawCallback": initialize_tooltips
            }
        );

        library_list.css("width", "");
    });

    function initialize_tooltips()
    {
        const tooltip_elements = jQuery('[data-toggle="tooltip"]');
        tooltip_elements.tooltip();
        tooltip_elements.click(function ()
        {
            jQuery(this).tooltip("hide");
        });
    }
</script>

    


<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>



<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script>
jQuery(function ()
{
  $('pre').each(function (index)
  {
    hljs.highlightBlock(this);
  });
});
</script>



    
<script src="/js/math-code.js"></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    



    
  </body>
</html>

