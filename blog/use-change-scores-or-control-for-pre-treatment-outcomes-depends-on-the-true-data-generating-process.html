<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.79.0" />


  <title>Use change scores or control for pre-treatment outcomes? Depends on the true data generating process - DeclareDesign</title>




  









<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css'>



<script defer src="https://use.fontawesome.com/releases/v5.5.0/js/all.js" integrity="sha384-GqVMZRt5Gn7tB9D9q7ONtcp4gtHIUEW/yG7h98J7IpE3kpi+srfFyyB/04OV6pG0" crossorigin="anonymous"></script>

<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet">

<link rel="stylesheet" href="/css/bootstrap.min.css">

<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>






  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Use change scores or control for pre-treatment outcomes? Depends on the true data generating process">
  <meta name="twitter:description" content='We’re in an observational study setting in which treatment assignment was not controlled by the researcher. We have pre-treatment data on baseline outcomes and we’d like to incorporate them, mainly to decrease bias due to confounding and but also, ideally, to increase precision. One approach is to use the difference between pre and post outcomes as the outcome variable; another is to use the baseline data as a control. Which is better?

'>






<script src="/js/dropdown_menu.js"></script>
<link rel="stylesheet" href="/css/custom.css">

  </head>
  <body>
    <div class="wrapper">
      
        
<header>
  <div class="navbar-wrap fixed-top bg-white">
    <nav class="navbar navbar-expand-lg navbar-light">
      <div class="container-fluid"> <a class="navbar-brand" href="/"><img src="/images/brand.svg" alt=""></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item"><a class="nav-link" href="/getting-started.html">Getting Started</a></li>
            <li class="nav-item"><a class="nav-link" href="/r/designlibrary">Library</a></li>
            <li class="nav-item dropdown">
              
              <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Software <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/r/declaredesign/">DeclareDesign</a></li>
                <li><a class="dropdown-item" href="/r/randomizr/">randomizr</a></li>
                <li><a class="dropdown-item" href="/r/fabricatr/">fabricatr</a></li>
                <li><a class="dropdown-item" href="/r/estimatr/">estimatr</a></li>
                <li><a class="dropdown-item" href="/r/designlibrary/">DesignLibrary</a></li>
              </ul>
            </li>
            <li class="nav-item"><a class="nav-link" href="/blog.html">Blog</a></li>
            <li class="nav-item"><a class="nav-link" href="/about.html">About</a></li>
            <li class="nav-item"><a target="_blank" class="nav-link" href="http://discuss.declaredesign.org/">Help</a></li>
          </ul>
        </div>
      </div>
    </nav>
  </div>
</header>

 

      


<main class="container">
  <div class="row justify-content-between">
    <div class="col-lg-12" id="content_column">
      <article class="article">

        <a class="h1 d-block mb-3" href="/blog">DeclareDesign Blog</a>
        <h2 class="article-title">Use change scores or control for pre-treatment outcomes? Depends on the true data generating process</h2>

        
        <span class="article-date">2019/01/15</span>
        

        <div class="article-content">
          
<link href="/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>


<p>We’re in an observational study setting in which treatment assignment was not controlled by the researcher. We have pre-treatment data on baseline outcomes and we’d like to incorporate them, mainly to decrease bias due to confounding and but also, ideally, to increase precision. One approach is to use the difference between pre and post outcomes as the outcome variable; another is to use the baseline data as a control. Which is better?</p>
<p>For a discussion see <a href="https://andrewgelman.com/2007/02/15/differenceindif/">this post</a> by Andrew Gelman and follow up comments by Winston Lin (that led us to the Allison reference we use below) and by Jens Hainmueller (that describes this logic).</p>
<p>In this post, design diagnosis shows that which approach is best depends on how outcomes are generated in the first place. A differencing approach might sometimes be effective at removing confounding bias but might do so at a cost of greater variance. Using this approach might not be optimal if confounding risks are small. Indeed, when there is no confounding (as in a randomized experiment), controlling is generally superior to differencing.</p>
<div id="assessing-tradeoffs-via-diagnosis" class="section level1">
<h1>Assessing tradeoffs via diagnosis</h1>
<p>To illustrate, we declare a two-period, two-arm design in which a unit-specific shock <span class="math inline">\(u\)</span> (with standard deviation .5) is present in each of the two periods. This shock is also possibly correlated with treatment assignment. In addition there are independent unit/period specific shocks, <span class="math inline">\(e_1\)</span> and <span class="math inline">\(e_2\)</span> (with unit standard deviations). For the illustration we assume a unit treatment effect:</p>
<p><span class="math display">\[Y_1 = u + e_1\]</span>
<span class="math display">\[Y_2 = Z + u + e_2\]</span></p>
<p>A parameter in the design, <span class="math inline">\(r\)</span> controls the degree of confounding. With <span class="math inline">\(r = 0\)</span> there is as-if random assignment; with <span class="math inline">\(r = 1\)</span> treatment assignment probabilities are directly related to <span class="math inline">\(u\)</span>.</p>
<p>Here is the declaration:</p>
<pre class="r"><code>r &lt;- 1   # magnitude of confounding

prepost &lt;- 
  
  declare_population(N = 100, 
                     u = rnorm(N) / 2, 
                     e1 = rnorm(N), 
                     e2 = rnorm(N), 
                     Y1 = u + e1) + 
  
  declare_assignment(prob = r * pnorm(u) + (1 - r) * .5, simple = TRUE) +
  
  declare_potential_outcomes(Y2 ~ Z + u + e2) + 
  
  declare_estimand(ate = mean(Y2_Z_1 - Y2_Z_0)) +
  
  declare_reveal(outcome_variables = Y2) +
  
  declare_step(D = Y2 - Y1, handler = fabricate) +
  
  declare_estimator(Y2 ~ Z, model = lm_robust, estimand = &quot;ate&quot;, 
                    label = &quot;Naive&quot;) +
  
  declare_estimator(Y2 ~ Z + Y1, model = lm_robust, estimand = &quot;ate&quot;, 
                    label = &quot;Condition on pretest&quot;) +
  
  declare_estimator(D ~ Z, model = lm_robust, estimand = &quot;ate&quot;, 
                    label = &quot;Change scores&quot;) </code></pre>
<p>We will diagnose a sequence of designs with different degrees of confounding:</p>
<pre class="r"><code>prepost_designs &lt;- redesign(prepost, r = seq(from = 0, to = 1, length = 5))
diagnosis       &lt;- diagnose_design(prepost_designs)</code></pre>
<p>Diagnosis reveals that the change score approach dominates the condition-on-pretest approach in terms of root mean squared error (RMSE) when the risk of bias is high but not when it is low.</p>
<pre class="r"><code>get_diagnosands(diagnosis) %&gt;%
  ggplot(aes(as.numeric(as.character(r)), rmse)) +
  geom_line(aes(color = estimator_label)) +
  theme_bw() + xlab(&quot;r&quot;)</code></pre>
<p><img src="/blog/2019-01-15-change-scores_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="what-drives-the-tradeoff" class="section level1">
<h1>What drives the tradeoff?</h1>
<p>We can take a closer look by decomposing RMSE into bias and variance.</p>
<p>Regardless of the value of <code>r</code>, change scores exhibit much less bias than conditioning. Units that are higher in the unobserved variable <span class="math inline">\(u\)</span> are higher in <span class="math inline">\(Y_2\)</span> and also more likely to be assigned to <span class="math inline">\(Z\)</span>. Putting <span class="math inline">\(Y_1\)</span> on the righthand side, however, does not solve this confounding, for reasons explained in <span class="citation">Allison (1990)</span> — in short, the regression model with <span class="math inline">\(Y_1\)</span> on the righthand side assumes that <span class="math inline">\(Y_1\)</span> is uncorrelated with the error term, which it is not.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>Differencing always does well here in terms of bias because it removes the shock, <span class="math inline">\(u\)</span>, that is associated with treatment assignment: <span class="math inline">\(D = Y_2 - Y_1 = Z + u + e_2- u - e_1 = Z + e_2 - e_1\)</span>.<br />
The naive approach does poorly here in terms of bias as it does nothing to account for confounding. Controlling for the pretest only partially removes the bias, which can remain quite substantial at high value of <code>r</code>.</p>
<p>The bias advantage for change scores is smaller at lower values of <code>r</code> and can be outweighed by the additional variance it introduces into the estimates. Change scores difference out <span class="math inline">\(u\)</span> at a cost of taking on both the <span class="math inline">\(e_1\)</span> and <span class="math inline">\(e_2\)</span> errors. In this design, <span class="math inline">\(Var(Y_2 | Z) = Var(u + e_2) = 1.25\)</span> whereas <span class="math inline">\(Var(Y_2 - Y_1 | Z) = Var(u + e_1 - u - e_2) = Var(e_1 - e_2) = 2\)</span>. Much noisier.</p>
<p><img src="/blog/2019-01-15-change-scores_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="takeaway" class="section level1">
<h1>Takeaway</h1>
<p>The takeaway is that with non-experimental designs you cannot have a general preference over these two approaches to taking account of baseline data. You need to use knowledge about how data is generated to determine the right approach. The type of confounding matters, as does the size of different types of errors. If you can speculate about these then diagnosis can help select a strategy (though even after diagnosis, how you choose can depend in part on how you weigh bias and error).</p>
<p>For experimental designs (represented here by the cases of r = 0), the choice between the two approaches is much clearer: don’t use change scores, control. The risk of bias is neglibile (see <span class="citation">Lin (2013)</span> on this point) and the estimates will be far more precise.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-allison1990change">
<p>Allison, Paul D. 1990. “Change Scores as Dependent Variables in Regression Analysis.” <em>Sociological Methodology</em>, 93–114.</p>
</div>
<div id="ref-lin2013agnostic">
<p>Lin, Winston. 2013. “Agnostic Notes on Regression Adjustments to Experimental Data: Reexamining Freedman’s Critique.” <em>The Annals of Applied Statistics</em> 7 (1): 295–318.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Indeed although the differencing approach has an “implied” coefficient of 1 on <span class="math inline">\(Y_1\)</span>, Allison (p 103) shows that the average estimated coefficient on <span class="math inline">\(Y_1\)</span> from the control approach will be less than 1. In our case it is, on average, just 0.18.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

        </div>
      </article>
      



    </div>
  </div>
</main>

    </div>

    

<footer>
    <div class="footer-top">
      <div class="container">
        <div class="row no-gutters">
          <div class="col-lg-7 col-md-12">
            <div class="row">
              <div class="col-md-3 col-12">
                <div class="footer-brand"><a href=""><img src="/images/brand-footer.svg" alt=""></a></div>
              </div>
              <div class="col-md-3 col-4">
                <p>DeclareDesign</p>
                <ul class="list-unstyled">
                  <li><a href="/">Home</a></li>
                  <li><a href="/about.html">About</a></li>
                  <li><a href="/r/designlibrary">Library</a></li>
                  <li><a href="/blog.html">Blog</a></li>
                  <li><a href="http://discuss.declaredesign.org/">Help</a></li>
                </ul>
              </div>
              <div class="col-md-3 col-4">
                <p>Software</p>
                <ul class="list-unstyled">
                  <li><a href="/r/declaredesign/">DeclareDesign</a></li>
                  <li><a href="/r/estimatr/">estimatr</a></li>
                  <li><a href="/r/randomizr/">randomizr</a></li>
                  <li><a href="/r/fabricatr/">fabricatr</a></li>
                  <li><a href="/r/designlibrary/">DesignLibrary</a></li>
                </ul>
              </div>
              
            </div>
          </div>
          <div class="col-lg-5 col-md-12"></div>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <div class="footer-meta-block">
        <div class="container">
          <div class="row align-items-center">
            <div class="col-sm-7">
              <p class="mb-0">&copy; 2021 Graeme Blair, Jasper Cooper, Alexander Coppock, and Macartan Humphreys</p>
            </div>
            <div class="col-sm-5">
              <div class="fbl-link-wrap">
                <ul class="list-inline mb-0">
                  <li class="list-inline-item"> <a target="_blank" href="http://github.com/DeclareDesign/"><img src="images/icon-git.svg" alt=""></a> </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>
  
   
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://cdn.datatables.net/v/bs4/dt-1.10.18/datatables.min.css"/>
<script src="https://cdn.datatables.net/v/bs4/dt-1.10.18/datatables.min.js"></script>

<script>
    jQuery(function ()
    {
        const library_list = jQuery("#design_library_list");
        library_list.addClass("table table-striped table-bordered");
        library_list.DataTable(
            {
                "autoWidth": false,
                "columns":
                    [
                        {"width": "30%"}, 
                        {"width": "10%"}, 
                        {"width": "10%"}, 
                        {"width": "10%"}, 
                        {"width": "15%"}, 
                        {"width": "25%"}, 
                    ],
                "drawCallback": initialize_tooltips
            }
        );

        library_list.css("width", "");
    });

    function initialize_tooltips()
    {
        const tooltip_elements = jQuery('[data-toggle="tooltip"]');
        tooltip_elements.tooltip();
        tooltip_elements.click(function ()
        {
            jQuery(this).tooltip("hide");
        });
    }
</script>

    


<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>



<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script>
jQuery(function ()
{
  $('pre').each(function (index)
  {
    hljs.highlightBlock(this);
  });
});
</script>



    
<script src="/js/math-code.js"></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    



    
  </body>
</html>

